import{u as J}from"./dict.10eb31b5.js";import{d as K,r as m,u as V}from"./index.0f5ebb0a.js";import{p as O,a as P,g as z}from"./channel.df6212a4.js";import{v as G}from"./index.c33ef0ff.js";import{l as T,r as g,R as H,aa as s,ah as Q,m as b,D as f,E as n,t as W,L as l,I as _,J as I,u as e,F as X,q as x,K as L,$ as w,j as Y,n as Z}from"./vue.4dfaac09.js";const ee={class:"dialog-footer"},ae=T({name:"PayChannelDialog"}),le=T({...ae,emits:["refresh"],setup(re,{expose:M,emit:N}){const q=N,{t:d}=K(),{status_type:R,channel_type:$}=J("status_type","channel_type"),v=g(),i=g(!1),h=g(!1),a=H({id:"",mchId:"",channelId:"",channelName:"",channelMchId:"",returnUrl:"",notifyUrl:"",state:"0",param:"",remark:"",appId:""}),j=g({appId:[{validator:m.overLength,trigger:"blur"},{required:!0,message:"appId\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],channelName:[{required:!0,message:"\u6E20\u9053\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:m.overLength,trigger:"blur"}],channelMchId:[{validator:m.overLength,trigger:"blur"},{required:!0,message:"\u5546\u6237ID\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],state:[{required:!0,message:"\u72B6\u6001\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:m.overLength,trigger:"blur"}],remark:[{validator:m.overLength,trigger:"blur"}],returnUrl:[{validator:m.overLength,trigger:"blur"},{validater:m.url,trigger:"blur"}],notifyUrl:[{required:!0,message:"\u540E\u7AEF\u56DE\u8C03\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:m.overLength,trigger:"blur"}],param:[{required:!0,message:"\u53C2\u6570\u914D\u7F6E\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:m.json,trigger:"blur"}]}),B=async()=>{if(!await v.value.validate().catch(()=>{}))return!1;try{h.value=!0;const{appId:o,channelMchId:r,param:u}=a;o!=null&&o.includes("**")&&(a.appId=void 0),r!=null&&r.includes("**")&&(a.channelMchId=void 0),u!=null&&u.includes("**")&&(a.param=void 0),a.id?await O(a):await P(a),V().success(d(a.id?"common.editSuccessText":"common.addSuccessText")),i.value=!1,q("refresh")}catch(o){V().error(o.msg)}finally{h.value=!1}},C=async o=>{h.value=!0;try{const r=await z(o);Object.assign(a,r.data)}catch{V().error("\u64CD\u4F5C\u5931\u8D25")}finally{h.value=!1}};return M({openDialog:o=>{i.value=!0,a.id="",Z(()=>{v.value.resetFields()}),o&&(a.id=o,C(o))}}),(o,r)=>{const u=s("el-input"),p=s("el-form-item"),c=s("el-col"),y=s("el-option"),U=s("el-select"),D=s("tip"),F=s("el-row"),E=s("el-form"),k=s("el-button"),S=s("el-dialog"),A=Q("loading");return b(),f(S,{"close-on-click-modal":!1,title:e(a).id?o.$t("common.editBtn"):o.$t("common.addBtn"),draggable:"",modelValue:e(i),"onUpdate:modelValue":r[10]||(r[10]=t=>Y(i)?i.value=t:null)},{footer:n(()=>[W("span",ee,[l(k,{onClick:r[9]||(r[9]=t=>i.value=!1)},{default:n(()=>[_(I(o.$t("common.cancelButtonText")),1)]),_:1}),l(k,{onClick:B,type:"primary",disabled:e(h)},{default:n(()=>[_(I(o.$t("common.confirmButtonText")),1)]),_:1},8,["disabled"])])]),default:n(()=>[X((b(),f(E,{model:e(a),rules:e(j),"label-width":"100px",ref_key:"dataFormRef",ref:v},{default:n(()=>[l(F,{gutter:24},{default:n(()=>[l(c,{span:12,class:"mb20"},{default:n(()=>[l(p,{label:e(d)("channel.appId"),prop:"appId"},{default:n(()=>[l(u,{placeholder:e(d)("channel.inputAppIdTip"),modelValue:e(a).appId,"onUpdate:modelValue":r[0]||(r[0]=t=>e(a).appId=t)},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1}),l(c,{span:12,class:"mb20"},{default:n(()=>[l(p,{label:e(d)("channel.channelId"),prop:"state"},{default:n(()=>[l(U,{modelValue:e(a).channelId,"onUpdate:modelValue":r[1]||(r[1]=t=>e(a).channelId=t)},{default:n(()=>[(b(!0),x(L,null,w(e($),t=>(b(),f(y,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),l(c,{span:12,class:"mb20"},{default:n(()=>[l(p,{label:e(d)("channel.channelName"),prop:"channelName"},{default:n(()=>[l(u,{placeholder:e(d)("channel.inputChannelNameTip"),modelValue:e(a).channelName,"onUpdate:modelValue":r[2]||(r[2]=t=>e(a).channelName=t)},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1}),l(c,{span:12,class:"mb20"},{default:n(()=>[l(p,{label:e(d)("channel.mchId"),prop:"channelMchId"},{default:n(()=>[l(u,{placeholder:e(d)("channel.inputMchIdTip"),modelValue:e(a).channelMchId,"onUpdate:modelValue":r[3]||(r[3]=t=>e(a).channelMchId=t)},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1}),l(c,{span:12,class:"mb20"},{default:n(()=>[l(p,{label:e(d)("channel.state"),prop:"state"},{default:n(()=>[l(U,{modelValue:e(a).state,"onUpdate:modelValue":r[4]||(r[4]=t=>e(a).state=t)},{default:n(()=>[(b(!0),x(L,null,w(e(R),t=>(b(),f(y,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),l(c,{span:24,class:"mb20"},{default:n(()=>[l(p,{label:e(d)("channel.returnUrl"),prop:"returnUrl"},{default:n(()=>[l(u,{placeholder:e(d)("channel.inputReturnUrlTip"),modelValue:e(a).returnUrl,"onUpdate:modelValue":r[5]||(r[5]=t=>e(a).returnUrl=t)},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1}),l(c,{span:24,class:"mb20"},{default:n(()=>[l(p,{label:e(d)("channel.notifyUrl"),prop:"notifyUrl"},{default:n(()=>[l(u,{placeholder:e(d)("channel.inputNotifyUrlTip"),modelValue:e(a).notifyUrl,"onUpdate:modelValue":r[6]||(r[6]=t=>e(a).notifyUrl=t)},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1}),l(c,{span:24,class:"mb20"},{default:n(()=>[l(p,{label:e(d)("channel.param"),prop:"param"},{label:n(()=>[_(I(e(d)("channel.param"))+" ",1),l(D,{content:"\u53C2\u8003\u652F\u4ED8\u6E20\u9053\u6587\u6863\u914D\u7F6Ejson\u683C\u5F0F"})]),default:n(()=>[l(e(G),{ref:"jsonEditorRef",modelValue:e(a).param,"onUpdate:modelValue":r[7]||(r[7]=t=>e(a).param=t)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1}),l(c,{span:24,class:"mb20"},{default:n(()=>[l(p,{label:e(d)("channel.remark"),prop:"remark"},{default:n(()=>[l(u,{placeholder:e(d)("channel.inputRemarkTip"),rows:2,type:"textarea",modelValue:e(a).remark,"onUpdate:modelValue":r[8]||(r[8]=t=>e(a).remark=t)},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[A,e(h)]])]),_:1},8,["title","modelValue"])}}});export{le as default};
