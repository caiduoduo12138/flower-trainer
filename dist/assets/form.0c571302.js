import{d as P,ac as E,r as _,ad as H,ae as J,af as O,u as v,ag as z,aa as A}from"./index.0f5ebb0a.js";import{l as k,r as p,R as D,aa as s,ah as G,m as n,D as b,E as t,t as M,L as d,I as V,J as x,u as o,F as Q,q as W,K as X,$ as Y,H as Z,j as ee,n as le}from"./vue.4dfaac09.js";const ae={class:"dialog-footer"},oe=k({name:"systemRoleDialog"}),re=k({...oe,emits:["refresh"],setup(te,{expose:T,emit:$}){const C=$,{t:S}=P(),h=p(),y=p(),c=p(!1),g=p(!1),l=D({roleId:"",roleName:"",roleCode:"",roleDesc:"",dsType:0,dsScope:""}),i=D({deptData:[],checkedDsScope:[],deptProps:{children:"children",label:"name",value:"id"}}),I=p({roleName:[{required:!0,message:"\u89D2\u8272\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:3,max:20,message:"\u957F\u5EA6\u5728 3 \u5230 20 \u4E2A\u5B57\u7B26",trigger:"blur"},{validator:(e,a,u)=>{E(e,a,u,l.roleId!=="")},trigger:"blur"}],roleCode:[{required:!0,message:"\u89D2\u8272\u6807\u8BC6\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:3,max:20,message:"\u957F\u5EA6\u5728 3 \u5230 20 \u4E2A\u5B57\u7B26",trigger:"blur"},{validator:_.validatorCapital,trigger:"blur"},{validator:(e,a,u)=>{H(e,a,u,l.roleId!=="")},trigger:"blur"}],roleDesc:[{validator:_.overLength,trigger:"blur"}],dsType:[{required:!0,message:"\u8BF7\u9009\u62E9\u6570\u636E\u6743\u9650\u7C7B\u578B",trigger:"blur"}],menu_authority:[{required:!0,message:"\u6570\u636E\u6743\u9650\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),w=p([{label:"\u5168\u90E8",value:0},{label:"\u81EA\u5B9A\u4E49",value:1},{label:"\u672C\u7EA7\u53CA\u5B50\u7EA7",value:2},{label:"\u672C\u7EA7",value:3},{label:"\u672C\u4EBA",value:4}]),N=async()=>{if(l.dsType===1?l.dsScope=y.value.getCheckedKeys().join(","):l.dsScope="",!await h.value.validate().catch(()=>{}))return!1;try{g.value=!0,l.roleId?await J(l):await O(l),v().success(S(l.roleId?"common.editSuccessText":"common.addSuccessText")),c.value=!1,C("refresh")}catch(e){v().error(e.msg)}finally{g.value=!1}},q=e=>{z(e).then(a=>{Object.assign(l,a.data),a.data.dsScope?i.checkedDsScope=a.data.dsScope.split(","):i.checkedDsScope=[]})},U=()=>{A().then(e=>{i.deptData=e.data})};return T({openDialog:e=>{c.value=!0,l.roleId="",le(()=>{h.value.resetFields()}),e&&(l.roleId=e,q(e)),U()}}),(e,a)=>{const u=s("el-input"),m=s("el-form-item"),B=s("el-option"),R=s("el-select"),j=s("el-tree"),F=s("el-form"),f=s("el-button"),K=s("el-dialog"),L=G("loading");return n(),b(K,{"close-on-click-modal":!1,title:o(l).roleId?e.$t("common.editBtn"):e.$t("common.addBtn"),width:"600",draggable:"",modelValue:o(c),"onUpdate:modelValue":a[5]||(a[5]=r=>ee(c)?c.value=r:null)},{footer:t(()=>[M("span",ae,[d(f,{onClick:a[4]||(a[4]=r=>c.value=!1)},{default:t(()=>[V(x(e.$t("common.cancelButtonText")),1)]),_:1}),d(f,{onClick:N,type:"primary",disabled:o(g)},{default:t(()=>[V(x(e.$t("common.confirmButtonText")),1)]),_:1},8,["disabled"])])]),default:t(()=>[Q((n(),b(F,{model:o(l),rules:o(I),"label-width":"90px",ref_key:"dataFormRef",ref:h},{default:t(()=>[d(m,{label:e.$t("sysrole.roleName"),prop:"roleName"},{default:t(()=>[d(u,{placeholder:e.$t("sysrole.please_enter_a_role_name"),clearable:"",modelValue:o(l).roleName,"onUpdate:modelValue":a[0]||(a[0]=r=>o(l).roleName=r)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),d(m,{label:e.$t("sysrole.roleCode"),prop:"roleCode"},{default:t(()=>[d(u,{placeholder:e.$t("sysrole.please_enter_the_role_Code"),disabled:o(l).roleId!=="",clearable:"",modelValue:o(l).roleCode,"onUpdate:modelValue":a[1]||(a[1]=r=>o(l).roleCode=r)},null,8,["placeholder","disabled","modelValue"])]),_:1},8,["label"]),d(m,{label:e.$t("sysrole.roleDesc"),prop:"roleDesc"},{default:t(()=>[d(u,{maxlength:"100",rows:3,placeholder:e.$t("sysrole.please_enter_the_role_description"),type:"textarea",modelValue:o(l).roleDesc,"onUpdate:modelValue":a[2]||(a[2]=r=>o(l).roleDesc=r)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),d(m,{label:e.$t("sysrole.menu_authority"),prop:"dsType"},{default:t(()=>[d(R,{placeholder:e.$t("sysrole.please_select"),clearable:"",modelValue:o(l).dsType,"onUpdate:modelValue":a[3]||(a[3]=r=>o(l).dsType=r)},{default:t(()=>[(n(!0),W(X,null,Y(o(w),r=>(n(),b(B,{key:r.value,label:r.label,value:r.value},null,8,["label","value"]))),128))]),_:1},8,["placeholder","modelValue"])]),_:1},8,["label"]),o(l).dsType===1?(n(),b(m,{key:0},{default:t(()=>[d(j,{"check-strictly":!0,data:o(i).deptData,"default-checked-keys":o(i).checkedDsScope,props:o(i).deptProps,"default-expand-all":"","highlight-current":"","node-key":"id",ref_key:"deptTreeRef",ref:y,"show-checkbox":""},null,8,["data","default-checked-keys","props"])]),_:1})):Z("",!0)]),_:1},8,["model","rules"])),[[L,o(g)]])]),_:1},8,["title","modelValue"])}}});export{re as default};
