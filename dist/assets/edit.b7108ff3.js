import{b as j,__tla as al}from"./index.0f5ebb0a.js";import{l as ol,r as b,R as _,h as tl,n as ul,aa as n,m as r,q as v,L as a,E as t,u as m,j as D,K as f,$ as h,D as w,P as dl,av as B}from"./vue.4dfaac09.js";import{u as rl,e as ml,g as il}from"./table.a96d0687.js";import{l as pl}from"./fieldtype.651e3d76.js";import{S as bl}from"./sortable.esm.71d81605.js";let H,nl=Promise.all([(()=>{try{return al}catch{}})()]).then(async()=>{H=ol({__name:"edit",props:{tableName:{type:String},dsName:{type:String}},setup(K,{expose:M}){const x=B(()=>j(()=>import("./index.7583ed8c.js"),["assets/index.7583ed8c.js","assets/sortable.esm.71d81605.js","assets/index.0f5ebb0a.js","assets/vue.4dfaac09.js","assets/index.3d43c53c.css","assets/index.16f42cf1.css"])),$=B(()=>j(()=>import("./add-dict.0cc51f8e.js"),["assets/add-dict.0cc51f8e.js","assets/index.0f5ebb0a.js","assets/vue.4dfaac09.js","assets/index.3d43c53c.css","assets/dict.10eb31b5.js"])),T=b(),q=b(""),N=K,z=b(!1),G=b(),S=b(),U=b([]),R=b([]),A=b(),k=b(),g=b(),i=b([]),J=_([{label:"DEFAULT",value:"DEFAULT"},{label:"INSERT",value:"INSERT"},{label:"UPDATE",value:"UPDATE"},{label:"INSERT_UPDATE",value:"INSERT_UPDATE"}]),Q=_([{label:"=",value:"="},{label:"!=",value:"!="},{label:">",value:">"},{label:">=",value:">="},{label:"<",value:"<"},{label:"<=",value:"<="},{label:"like",value:"like"},{label:"left like",value:"left like"},{label:"right like",value:"right like"}]),W=_([{label:"\u5355\u884C\u6587\u672C",value:"text"},{label:"\u591A\u884C\u6587\u672C",value:"textarea"},{label:"\u6570\u5B57",value:"number"},{label:"\u5BCC\u6587\u672C\u7F16\u8F91\u5668",value:"editor"},{label:"\u4E0B\u62C9\u6846",value:"select"},{label:"\u5355\u9009\u6309\u94AE",value:"radio"},{label:"\u590D\u9009\u6846",value:"checkbox"},{label:"\u65E5\u671F",value:"date"},{label:"\u65E5\u671F\u65F6\u95F4",value:"datetime"},{label:"\u6587\u4EF6\u4E0A\u4F20",value:"upload-file"},{label:"\u56FE\u7247\u4E0A\u4F20",value:"upload-img"}]),X=_([{label:"\u5355\u884C\u6587\u672C",value:"text"},{label:"\u591A\u884C\u6587\u672C",value:"textarea"},{label:"\u6570\u5B57",value:"number"},{label:"\u4E0B\u62C9\u6846",value:"select"},{label:"\u5355\u9009\u6309\u94AE",value:"radio"},{label:"\u590D\u9009\u6846",value:"checkbox"},{label:"\u65E5\u671F",value:"date"},{label:"\u65E5\u671F\u65F6\u95F4",value:"datetime"}]),Y=_([{label:"\u53BB\u91CD",value:"duplicate"},{label:"\u6570\u5B57",value:"number"},{label:"\u5B57\u6BCD",value:"letter"},{label:"\u5B57\u6BCD\u548C\u6570\u5B57",value:"letterAndNumber"},{label:"\u624B\u673A\u53F7\u7801",value:"mobilePhone"},{label:"\u5B57\u6BCD\u5F00\u5934\uFF0C\u4EC5\u53EF\u5305\u542B\u6570\u5B57",value:"letterStartNumberIncluded"},{label:"\u7981\u6B62\u4E2D\u6587\u8F93\u5165",value:"noChinese"},{label:"\u5FC5\u987B\u4E2D\u6587\u8F93\u5165",value:"chinese"},{label:"\u7535\u5B50\u90AE\u7BB1",value:"email"},{label:"URL\u7F51\u5740",value:"url"}]),P=_({tinyint:"number",smallint:"number",mediumint:"number",int:"number",integer:"number",bigint:"number",float:"number",datetime:"datetime",LocalDateTime:"datetime",date:"date",LocalDate:"date",Long:"number",Float:"number",Double:"number",BigDecimal:"number",text:"textarea",String:"text",longtext:"editor",bit:"radio",Boolean:"radio",char:"radio",varchar:"text"}),Z=async d=>{await E(),A.value.fieldDict=d};tl(()=>{g.value=String(N.tableName),k.value=String(N.dsName),T.value="field",F(),L(k.value,g.value),O(),E()});const F=()=>{ul(()=>{const d=window.document.querySelector("#pane-field");G.value=bl.create(d,{handle:".drag-btn",onEnd:u=>{const{newIndex:p,oldIndex:o}=u,y=i.value.splice(o,1)[0];i.value.splice(p,0,y)}})})},C=b(!1),L=(d,u)=>{i.value=[],C.value=!0,rl(d,u).then(p=>{q.value=p.data.id,i.value=p.data.fieldList.map(o=>(o.queryFormType?o.queryFormType:P[o.fieldType],o.formType?o.formType:P[o.fieldType],o))}).finally(()=>{C.value=!1})},O=async()=>{U.value=[];const{data:d}=await pl(),u=new Map;d.forEach(p=>{const{attrType:o,columnType:y}=p;u.has(o)||(u.set(o,y),U.value.push({label:o,value:o}))}),U.value.push({label:"Object",value:"Object"})},E=()=>{ml().then(d=>{for(const u of d.data)R.value.push({label:u.description,value:u.dictType})})};return M({openDialog:(d,u)=>{z.value=!0,g.value=u,k.value=d,T.value="field",F(),L(d,u),O(),E()},submitHandle:()=>new Promise(d=>{il(k.value,g.value,i.value).then(()=>{d(q.value)})})}),(d,u)=>{const p=n("el-checkbox"),o=n("el-table-column"),y=n("el-input"),s=n("el-option"),V=n("el-select"),ll=n("el-button"),I=n("el-tab-pane"),el=n("el-tabs");return r(),v(f,null,[a(el,{modelValue:m(T),"onUpdate:modelValue":u[3]||(u[3]=l=>D(T)?T.value=l:null)},{default:t(()=>[a(I,{label:"\u5C5E\u6027\u8BBE\u7F6E",name:"field"},{default:t(()=>[a(m(x),{ref:"fieldTable",modelValue:m(i),"onUpdate:modelValue":u[0]||(u[0]=l=>D(i)?i.value=l:null),hideAdd:!0,hideDelete:!0,"drag-sort":"",placeholder:"\u6682\u65E0\u6570\u636E"},{default:t(()=>[a(o,{label:"\u4E3B\u952E",prop:"primaryPk",width:"80","show-overflow-tooltip":""},{default:t(({row:l})=>[a(p,{modelValue:l.primaryPk,"onUpdate:modelValue":e=>l.primaryPk=e,"true-label":"1","false-label":"0",disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(o,{label:"\u5B57\u6BB5\u540D",prop:"fieldName","show-overflow-tooltip":""}),a(o,{label:"\u8BF4\u660E",prop:"fieldComment","show-overflow-tooltip":""},{default:t(({row:l})=>[a(y,{modelValue:l.fieldComment,"onUpdate:modelValue":e=>l.fieldComment=e,placeholder:"\u8BF7\u8F93\u5165\u8BF4\u660E"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(o,{label:"\u5B57\u6BB5\u7C7B\u578B",prop:"fieldType","show-overflow-tooltip":""}),a(o,{label:"\u5C5E\u6027\u540D",prop:"attrName","show-overflow-tooltip":""},{default:t(({row:l})=>[a(y,{modelValue:l.attrName,"onUpdate:modelValue":e=>l.attrName=e,placeholder:"\u8BF7\u8F93\u5165\u5C5E\u6027\u540D"},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),a(o,{label:"\u5C5E\u6027\u7C7B\u578B",prop:"attrType","show-overflow-tooltip":""},{default:t(({row:l})=>[a(V,{modelValue:l.attrType,"onUpdate:modelValue":e=>l.attrType=e,placeholder:"\u8BF7\u9009\u62E9\u5C5E\u6027\u7C7B\u578B",onChange:e=>(c=>{c.queryFormType=P[c.attrType],c.formType=P[c.attrType]})(l)},{default:t(()=>[(r(!0),v(f,null,h(m(U),e=>(r(),w(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),a(o,{label:"\u81EA\u52A8\u586B\u5145",prop:"autoFill","show-overflow-tooltip":""},{default:t(({row:l})=>[a(V,{modelValue:l.autoFill,"onUpdate:modelValue":e=>l.autoFill=e,placeholder:"\u8BF7\u9009\u62E9\u7C7B\u578B"},{default:t(()=>[(r(!0),v(f,null,h(m(J),e=>(r(),w(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),a(o,{label:"\u5B57\u5178\u540D\u79F0",prop:"fieldDict","show-overflow-tooltip":""},{default:t(({row:l})=>[a(V,{modelValue:l.fieldDict,"onUpdate:modelValue":e=>l.fieldDict=e,placeholder:"\u8BF7\u9009\u62E9\u7C7B\u578B",filterable:"",clearable:"",disabled:l.primaryPk==="1"},{prefix:t(()=>[a(ll,{icon:"Plus",type:"primary",link:"",onClick:dl(e=>(c=>{A.value=c,S.value.openDialog()})(l),["stop"])},null,8,["onClick"])]),default:t(()=>[(r(!0),v(f,null,h(m(R),e=>(r(),w(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(I,{label:"\u5217\u8868\u67E5\u8BE2",name:"third"},{default:t(()=>[a(m(x),{ref:"gridTable",modelValue:m(i),"onUpdate:modelValue":u[1]||(u[1]=l=>D(i)?i.value=l:null),hideAdd:!0,hideDelete:!0,placeholder:"\u6682\u65E0\u6570\u636E"},{default:t(()=>[a(o,{label:"\u5C5E\u6027\u540D",prop:"attrName","show-overflow-tooltip":""}),a(o,{label:"\u8BF4\u660E",prop:"fieldComment","show-overflow-tooltip":""}),a(o,{label:"\u5217\u8868\u663E\u793A",prop:"gridItem",width:"100","show-overflow-tooltip":""},{default:t(({row:l})=>[a(p,{modelValue:l.gridItem,"onUpdate:modelValue":e=>l.gridItem=e,"true-label":"1","false-label":"0",disabled:l.primaryPk==="1"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),a(o,{label:"\u662F\u5426\u6392\u5E8F",prop:"gridSort",width:"100","show-overflow-tooltip":""},{default:t(({row:l})=>[a(p,{modelValue:l.gridSort,"onUpdate:modelValue":e=>l.gridSort=e,"true-label":"1","false-label":"0",disabled:l.primaryPk==="1"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),a(o,{label:"\u67E5\u8BE2\u663E\u793A",prop:"gridSort",width:"100","show-overflow-tooltip":""},{default:t(({row:l})=>[a(p,{modelValue:l.queryItem,"onUpdate:modelValue":e=>l.queryItem=e,"true-label":"1","false-label":"0",disabled:l.primaryPk==="1"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),a(o,{label:"\u67E5\u8BE2\u8868\u5355\u7C7B\u578B",prop:"queryFormType","show-overflow-tooltip":""},{default:t(({row:l})=>[a(V,{modelValue:l.queryFormType,"onUpdate:modelValue":e=>l.queryFormType=e,placeholder:"\u8BF7\u9009\u62E9\u67E5\u8BE2\u8868\u5355\u7C7B\u578B",disabled:l.primaryPk==="1"},{default:t(()=>[(r(!0),v(f,null,h(m(X),e=>(r(),w(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),a(o,{label:"\u67E5\u8BE2\u65B9\u5F0F",prop:"queryType","show-overflow-tooltip":""},{default:t(({row:l})=>[a(V,{modelValue:l.queryType,"onUpdate:modelValue":e=>l.queryType=e,placeholder:"\u8BF7\u9009\u62E9\u67E5\u8BE2\u65B9\u5F0F",disabled:l.primaryPk==="1"},{default:t(()=>[(r(!0),v(f,null,h(m(Q),e=>(r(),w(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(I,{label:"\u8868\u5355\u9875\u9762",name:"form"},{default:t(()=>[a(m(x),{ref:"formTable",modelValue:m(i),"onUpdate:modelValue":u[2]||(u[2]=l=>D(i)?i.value=l:null),hideAdd:!0,hideDelete:!0,placeholder:"\u6682\u65E0\u6570\u636E"},{default:t(()=>[a(o,{label:"\u5C5E\u6027\u540D",prop:"attrName","show-overflow-tooltip":""}),a(o,{label:"\u8BF4\u660E",prop:"fieldComment","show-overflow-tooltip":""}),a(o,{label:"\u8868\u5355\u7C7B\u578B",prop:"formType","show-overflow-tooltip":""},{default:t(({row:l})=>[a(V,{modelValue:l.formType,"onUpdate:modelValue":e=>l.formType=e,placeholder:"\u8BF7\u9009\u62E9\u8868\u5355\u7C7B\u578B",disabled:l.primaryPk==="1"},{default:t(()=>[(r(!0),v(f,null,h(m(W),e=>(r(),w(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),a(o,{label:"\u662F\u5426\u663E\u793A",prop:"formItem",width:"100","show-overflow-tooltip":""},{default:t(({row:l})=>[a(p,{modelValue:l.formItem,"onUpdate:modelValue":e=>l.formItem=e,"true-label":"1","false-label":"0",disabled:l.primaryPk==="1"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),a(o,{label:"\u8868\u5355\u5FC5\u586B",prop:"formRequired",width:"100","show-overflow-tooltip":""},{default:t(({row:l})=>[a(p,{modelValue:l.formRequired,"onUpdate:modelValue":e=>l.formRequired=e,"true-label":"1","false-label":"0",disabled:l.primaryPk==="1"},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:1}),a(o,{label:"\u8868\u5355\u6548\u9A8C",prop:"formValidator","show-overflow-tooltip":""},{default:t(({row:l})=>[a(V,{modelValue:l.formValidator,"onUpdate:modelValue":e=>l.formValidator=e,placeholder:"\u8BF7\u9009\u62E9\u8868\u5355\u6548\u9A8C",disabled:l.primaryPk==="1",clearable:""},{default:t(()=>[(r(!0),v(f,null,h(m(Y),e=>(r(),w(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),a(m($),{ref_key:"formDialogRef",ref:S,onRefresh:Z},null,512)],64)}}})});export{nl as __tla,H as default};
