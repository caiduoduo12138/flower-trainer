import{d as U,r as F,u as f}from"./index.0f5ebb0a.js";import{v as R,a as j,p as q,b as E,g as J}from"./approle.6eae0692.js";import{l as h,r as i,R as _,aa as c,ah as L,m as v,D,E as t,t as O,L as d,I as x,J as V,u as o,F as P,j as z,n as A}from"./vue.4dfaac09.js";const G={class:"dialog-footer"},H=h({name:"systemRoleDialog"}),K=h({...H,emits:["refresh"],setup(M,{expose:C,emit:$}){const I=$,{t:y}=U(),p=i(),m=i(!1),u=i(!1),l=_({roleId:"",roleName:"",roleCode:"",roleDesc:""}),g=_({deptData:[],checkedDsScope:[],deptProps:{children:"children",label:"name",value:"id"}}),k=i({roleName:[{required:!0,message:"\u89D2\u8272\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:3,max:20,message:"\u957F\u5EA6\u5728 3 \u5230 20 \u4E2A\u5B57\u7B26",trigger:"blur"},{validator:(e,a,s)=>{R(e,a,s,l.roleId!=="")},trigger:"blur"}],roleCode:[{required:!0,message:"\u89D2\u8272\u6807\u8BC6\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:3,max:20,message:"\u957F\u5EA6\u5728 3 \u5230 20 \u4E2A\u5B57\u7B26",trigger:"blur"},{validator:F.validatorCapital,trigger:"blur"},{validator:(e,a,s)=>{j(e,a,s,l.roleId!=="")},trigger:"blur"}],roleDesc:[{max:128,message:"\u957F\u5EA6\u5728 128 \u4E2A\u5B57\u7B26\u5185",trigger:"blur"}]}),S=async()=>{if(!await p.value.validate().catch(()=>{}))return!1;try{u.value=!0,l.roleId?await q(l):await E(l),f().success(y(l.roleId?"common.editSuccessText":"common.addSuccessText")),m.value=!1,I("refresh")}catch(e){f().error(e.msg)}finally{u.value=!1}},N=e=>{J(e).then(a=>{Object.assign(l,a.data),a.data.dsScope?g.checkedDsScope=a.data.dsScope.split(","):g.checkedDsScope=[]})};return C({openDialog:e=>{m.value=!0,l.roleId="",A(()=>{var a;(a=p.value)==null||a.resetFields()}),e&&(l.roleId=e,N(e))}}),(e,a)=>{const s=c("el-input"),n=c("el-form-item"),w=c("el-form"),b=c("el-button"),B=c("el-dialog"),T=L("loading");return v(),D(B,{"close-on-click-modal":!1,title:o(l).roleId?e.$t("common.editBtn"):e.$t("common.addBtn"),width:"600",draggable:"",modelValue:o(m),"onUpdate:modelValue":a[4]||(a[4]=r=>z(m)?m.value=r:null)},{footer:t(()=>[O("span",G,[d(b,{onClick:a[3]||(a[3]=r=>m.value=!1)},{default:t(()=>[x(V(e.$t("common.cancelButtonText")),1)]),_:1}),d(b,{onClick:S,type:"primary",disabled:o(u)},{default:t(()=>[x(V(e.$t("common.confirmButtonText")),1)]),_:1},8,["disabled"])])]),default:t(()=>[P((v(),D(w,{model:o(l),rules:o(k),"label-width":"90px",ref_key:"dataFormRef",ref:p},{default:t(()=>[d(n,{label:e.$t("approle.roleName"),prop:"roleName"},{default:t(()=>[d(s,{placeholder:e.$t("approle.please_enter_a_role_name"),clearable:"",modelValue:o(l).roleName,"onUpdate:modelValue":a[0]||(a[0]=r=>o(l).roleName=r)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),d(n,{label:e.$t("approle.roleCode"),prop:"roleCode"},{default:t(()=>[d(s,{placeholder:e.$t("approle.please_enter_the_role_Code"),clearable:"",modelValue:o(l).roleCode,"onUpdate:modelValue":a[1]||(a[1]=r=>o(l).roleCode=r)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),d(n,{label:e.$t("approle.roleDesc"),prop:"roleDesc"},{default:t(()=>[d(s,{placeholder:e.$t("approle.please_enter_the_role_description"),maxlength:"150",type:"textarea",modelValue:o(l).roleDesc,"onUpdate:modelValue":a[2]||(a[2]=r=>o(l).roleDesc=r)},null,8,["placeholder","modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[T,o(u)]])]),_:1},8,["title","modelValue"])}}});export{K as default};
