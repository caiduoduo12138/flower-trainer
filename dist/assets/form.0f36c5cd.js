import{v as Z,a as ee,p as ae,b as le,f as te,g as de,t as ne}from"./tenant.bfd983bb.js";import{u as se}from"./dict.10eb31b5.js";import{d as re,r as K,u as h,o as oe}from"./index.0f5ebb0a.js";import{l as B,r as c,R as I,aa as o,ah as ue,m as b,D as v,E as n,t as V,L as d,I as x,J as T,u as e,F as ie,q as me,K as ce,$ as pe,H as U,j as fe,n as be}from"./vue.4dfaac09.js";const ge={class:"mr-4"},he={class:"dialog-footer"},ve=B({name:"systemTenantDialog"}),ye=B({...ve,emits:["refresh"],setup(Te,{expose:$,emit:q}){const F=q,{t:u}=re(),_=c(),i=c(),p=c(!1),y=c(!1),{status_type:S}=se("status_type"),l=I({id:"",name:"",code:"",tenantDomain:"",startTime:"",endTime:"",status:"0",delFlag:"",createBy:"",updateBy:"",createTime:"",updateTime:"",menuId:""}),g=c([]),j=I({label:"name",value:"id",disabled:!0}),k=c([]),L=c({name:[{validator:K.overLength,trigger:"blur"},{required:!0,message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:(t,a,s)=>{Z(t,a,s,l.id!=="")},trigger:"blur"}],code:[{validator:K.overLength,trigger:"blur"},{required:!0,message:"\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:(t,a,s)=>{ee(t,a,s,l.id!=="")},trigger:"blur"}],startTime:[{required:!0,message:"\u5F00\u59CB\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],endTime:[{required:!0,message:"\u7ED3\u675F\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],status:[{required:!0,message:"status\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),R=async()=>{var t,a;if(!await _.value.validate().catch(()=>{}))return!1;if(((t=i.value)==null?void 0:t.getCheckedKeys().length)===0)return h().error("\u8BF7\u9009\u62E9\u79DF\u6237\u5957\u9910\u83DC\u5355"),!1;if((a=i.value)!=null&&a.getCheckedKeys()){let s=[...i.value.getCheckedKeys(),...i.value.getHalfCheckedKeys()];if(!s.includes("1300"))return h().error("\u5FC5\u987B\u5206\u914D\u89D2\u8272\u7BA1\u7406\u529F\u80FD"),!1;if(!s.includes("1302"))return h().error("\u5FC5\u987B\u5206\u914D\u89D2\u8272\u7BA1\u7406\u529F\u80FD"),!1;l.menuId=s.join(",")}try{y.value=!0,l.id?await ae(l):await le(l),h().success(u(l.id?"common.editSuccessText":"common.addSuccessText")),p.value=!1,F("refresh")}catch(s){h().error(s.msg)}finally{await te(),y.value=!1}},A=async t=>{const a=await de(t);Object.assign(l,a.data)},E=async()=>{const t=await ne();g.value=t.data,k.value=l.menuId?oe.resolveAllEunuchNodeId(g.value,l.menuId.split(","),[]):[]},H=t=>{const a=g.value;for(let s=0;s<a.length;s++)i.value.store.nodesMap[a[s].id].expanded=t},z=t=>{var a,s;t?(a=i.value)==null||a.setCheckedKeys(g.value.map(m=>m.id)):(s=i.value)==null||s.setCheckedKeys([])};return $({openDialog:t=>{p.value=!0,l.id="",l.menuId="",k.value=[],be(()=>{var a;(a=_.value)==null||a.resetFields()}),t&&(l.id=t,A(t)),E()}}),(t,a)=>{const s=o("el-input"),m=o("el-form-item"),f=o("el-col"),w=o("el-date-picker"),J=o("el-radio"),M=o("el-radio-group"),C=o("el-checkbox"),N=o("el-divider"),O=o("el-tree"),G=o("el-scrollbar"),P=o("el-row"),Q=o("el-form"),D=o("el-button"),W=o("el-drawer"),X=ue("loading");return b(),v(W,{title:e(l).id?t.$t("common.editBtn"):t.$t("common.addBtn"),modelValue:e(p),"onUpdate:modelValue":a[7]||(a[7]=r=>fe(p)?p.value=r:null),"close-on-click-modal":!0,draggable:"",size:"50%"},{footer:n(()=>[V("span",he,[d(D,{onClick:a[6]||(a[6]=r=>p.value=!1)},{default:n(()=>[x(T(t.$t("common.cancelButtonText")),1)]),_:1}),d(D,{type:"primary",onClick:R,disabled:e(y)},{default:n(()=>[x(T(t.$t("common.confirmButtonText")),1)]),_:1},8,["disabled"])])]),default:n(()=>[ie((b(),v(Q,{ref_key:"dataFormRef",ref:_,model:e(l),rules:e(L),"label-width":"90px"},{default:n(()=>[d(P,{gutter:20},{default:n(()=>[d(f,{span:12,class:"mb20"},{default:n(()=>[d(m,{label:e(u)("tenant.name"),prop:"name"},{default:n(()=>[d(s,{modelValue:e(l).name,"onUpdate:modelValue":a[0]||(a[0]=r=>e(l).name=r),placeholder:e(u)("tenant.inputnameTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),d(f,{span:12,class:"mb20"},{default:n(()=>[d(m,{label:e(u)("tenant.code"),prop:"code"},{default:n(()=>[d(s,{modelValue:e(l).code,"onUpdate:modelValue":a[1]||(a[1]=r=>e(l).code=r),placeholder:e(u)("tenant.inputcodeTip"),disabled:e(l).id!==""},null,8,["modelValue","placeholder","disabled"])]),_:1},8,["label"])]),_:1}),d(f,{span:12,class:"mb20"},{default:n(()=>[d(m,{label:e(u)("tenant.startTime"),prop:"startTime"},{default:n(()=>[d(w,{class:"!w-full",modelValue:e(l).startTime,"onUpdate:modelValue":a[2]||(a[2]=r=>e(l).startTime=r),type:"date",placeholder:e(u)("tenant.inputstartTimeTip"),"value-format":t.dateTimeStr},null,8,["modelValue","placeholder","value-format"])]),_:1},8,["label"])]),_:1}),d(f,{span:12,class:"mb20"},{default:n(()=>[d(m,{label:e(u)("tenant.endTime"),prop:"endTime"},{default:n(()=>[d(w,{class:"!w-full",modelValue:e(l).endTime,"onUpdate:modelValue":a[3]||(a[3]=r=>e(l).endTime=r),type:"date",placeholder:e(u)("tenant.inputendTimeTip"),"value-format":t.dateTimeStr},null,8,["modelValue","placeholder","value-format"])]),_:1},8,["label"])]),_:1}),d(f,{span:12,class:"mb20"},{default:n(()=>[d(m,{span:12,label:e(u)("tenant.tenantDomain"),prop:"tenantDomain"},{default:n(()=>[d(s,{modelValue:e(l).tenantDomain,"onUpdate:modelValue":a[4]||(a[4]=r=>e(l).tenantDomain=r),placeholder:e(u)("tenant.inputtenantDomainTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),d(f,{span:12,class:"mb20"},{default:n(()=>[d(m,{label:e(u)("tenant.status"),prop:"status"},{default:n(()=>[d(M,{modelValue:e(l).status,"onUpdate:modelValue":a[5]||(a[5]=r=>e(l).status=r)},{default:n(()=>[(b(!0),me(ce,null,pe(e(S),(r,Y)=>(b(),v(J,{label:r.value,border:"",key:Y},{default:n(()=>[x(T(r.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(l).id!=="1"?(b(),v(N,{key:0,"content-position":"left"},{default:n(()=>[V("div",null,[V("span",ge,T(t.$t("tenantmenu.name")),1),d(C,{label:t.$t("common.expand"),onChange:H},null,8,["label"]),d(C,{label:t.$t("common.selectAll"),onChange:z},null,8,["label"])])]),_:1})):U("",!0),e(l).id!=="1"?(b(),v(G,{key:1,class:"h-[400px] sm:h-[600px] ml-12"},{default:n(()=>[d(O,{"show-checkbox":"",ref_key:"menuTreeRef",ref:i,disabled:!0,"check-strictly":!1,data:e(g),props:e(j),"default-checked-keys":e(k),"node-key":"id","highlight-current":""},null,8,["data","props","default-checked-keys"])]),_:1})):U("",!0)]),_:1})]),_:1},8,["model","rules"])),[[X,e(y)]])]),_:1},8,["title","modelValue"])}}});export{ye as default};
