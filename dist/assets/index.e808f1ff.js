import{d as re,y as ne,u as E,v as ie,b as de,__tla as me}from"./index.0f5ebb0a.js";import{l as z,r as h,as as se,R as ue,h as ce,aa as i,ah as A,m as y,q as H,t as I,F as _,M as pe,u as e,L as a,E as r,a0 as ye,K as be,$ as fe,D as g,I as d,J as m,j as he,A as _e,av as ge}from"./vue.4dfaac09.js";import{u as Ce}from"./table.6d12d51c.js";import{f as we,d as ve}from"./create-table.f7b672f0.js";import{l as xe}from"./datasource.a0355933.js";import{u as Ne,a as Fe}from"./table.a96d0687.js";let K,Te=Promise.all([(()=>{try{return me}catch{}})()]).then(async()=>{let T,k,q,S;T={class:"layout-padding"},k={class:"layout-padding-auto layout-padding-view"},q={class:"mb8",style:{width:"100%"}},S=z({name:"systemCreateTable"}),K=z({...S,setup(ke){const O=ge(()=>de(()=>import("./form.fb39d588.js"),["assets/form.fb39d588.js","assets/index.0f5ebb0a.js","assets/vue.4dfaac09.js","assets/index.3d43c53c.css","assets/create-table.f7b672f0.js","assets/dict.10eb31b5.js","assets/fieldtype.651e3d76.js","assets/table.a96d0687.js"])),{t:s}=re(),C=h(),v=h(),U=se(),$=h(),w=h(!0),x=h([]),B=h(!0),n=ue({queryForm:{},pageList:we,descs:["create_time"]}),{getDataList:u,currentChangeHandle:j,sizeChangeHandle:J,sortChangeHandle:P,downBlobFile:Q,tableStyle:D}=Ce(n),M=()=>{var l;(l=$.value)==null||l.resetFields(),x.value=[],u()},Y=()=>{Q("/order/create-table/export",n.queryForm,"create-table.xlsx")},G=l=>{x.value=l.map(({id:t})=>t),B.value=!l.length},V=async l=>{try{await ne().confirm(s("common.delConfirmText"))}catch{return}try{await ve(l),u(),E().success(s("common.delSuccessText"))}catch(t){E().error(t.msg)}};return ce(()=>{xe().then(l=>{var t;v.value=l.data,n.queryForm.dsName=((t=v.value[0])==null?void 0:t.name)||"master",u()})}),(l,t)=>{const L=i("el-option"),W=i("el-select"),N=i("el-form-item"),X=i("el-input"),c=i("el-button"),Z=i("el-form"),R=i("el-row"),ee=i("right-toolbar"),p=i("el-table-column"),ae=i("el-table"),le=i("pagination"),F=A("auth"),te=A("loading");return y(),H("div",T,[I("div",k,[_(a(R,null,{default:r(()=>[a(Z,{model:e(n).queryForm,ref_key:"queryRef",ref:$,inline:!0,onKeyup:ye(e(u),["enter"])},{default:r(()=>[a(N,{label:"\u6570\u636E\u6E90",prop:"name"},{default:r(()=>[a(W,{onChange:e(u),placeholder:"\u8BF7\u9009\u62E9\u6570\u636E\u6E90",modelValue:e(n).queryForm.dsName,"onUpdate:modelValue":t[0]||(t[0]=o=>e(n).queryForm.dsName=o)},{default:r(()=>[a(L,{label:"\u9ED8\u8BA4\u6570\u636E\u6E90",value:"master"}),(y(!0),H(be,null,fe(e(v),o=>(y(),g(L,{key:o.id,label:o.name,value:o.name},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue"])]),_:1}),a(N,{label:l.$t("createTable.tableName"),prop:"tableName"},{default:r(()=>[a(X,{placeholder:e(s)("createTable.inputTableNameTip"),modelValue:e(n).queryForm.tableName,"onUpdate:modelValue":t[1]||(t[1]=o=>e(n).queryForm.tableName=o)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),a(N,null,{default:r(()=>[a(c,{icon:"search",type:"primary",onClick:e(u)},{default:r(()=>[d(m(l.$t("common.queryBtn")),1)]),_:1},8,["onClick"]),a(c,{icon:"Refresh",onClick:M},{default:r(()=>[d(m(l.$t("common.resetBtn")),1)]),_:1})]),_:1})]),_:1},8,["model","onKeyup"])]),_:1},512),[[pe,e(w)]]),a(R,null,{default:r(()=>[I("div",q,[_((y(),g(c,{icon:"folder-add",type:"primary",class:"ml10",onClick:t[2]||(t[2]=o=>e(C).openDialog("add",null,e(n).queryForm.dsName))},{default:r(()=>[d(m(l.$t("common.addBtn")),1)]),_:1})),[[F,"codegen_table_add"]]),_((y(),g(c,{plain:"",disabled:e(B),icon:"Delete",type:"primary",class:"ml10",onClick:t[3]||(t[3]=o=>V(e(x)))},{default:r(()=>[d(m(l.$t("common.delBtn")),1)]),_:1},8,["disabled"])),[[F,"codegen_table_add"]]),a(ee,{showSearch:e(w),"onUpdate:showSearch":t[4]||(t[4]=o=>he(w)?w.value=o:null),export:"order_createtable_export",onExportExcel:Y,class:"ml10",style:{float:"right","margin-right":"20px"},onQueryTable:e(u)},null,8,["showSearch","onQueryTable"])])]),_:1}),_((y(),g(ae,{data:e(n).dataList,style:{width:"100%"},"cell-style":e(D).cellStyle,border:"","header-cell-style":e(D).headerCellStyle,onSelectionChange:G,onSortChange:e(P)},{default:r(()=>[a(p,{type:"selection",width:"40",align:"center"}),a(p,{type:"index",fixed:"left",label:e(s)("createTable.index"),width:"40"},null,8,["label"]),a(p,{prop:"tableName",label:e(s)("createTable.tableName"),"show-overflow-tooltip":""},null,8,["label"]),a(p,{prop:"comments",label:e(s)("createTable.comments"),"show-overflow-tooltip":""},null,8,["label"]),a(p,{prop:"primary",label:e(s)("createTable.primary"),"show-overflow-tooltip":""},{default:r(o=>{var b;return[d(m((b=JSON.parse(o.row.columnInfo).find(f=>f.primary===1))==null?void 0:b.name),1)]}),_:1},8,["label"]),a(p,{prop:"createTime",label:e(s)("createTable.createTime"),"show-overflow-tooltip":""},null,8,["label"]),a(p,{label:l.$t("common.action"),fixed:"right",width:"200"},{default:r(o=>[a(c,{text:"",type:"primary",icon:"view",onClick:b=>e(C).openDialog("view",o.row.id)},{default:r(()=>[d(m(l.$t("common.viewBtn")),1)]),_:2},1032,["onClick"]),a(c,{icon:"FolderOpened",onClick:b=>{return f=o.row,void Ne(n.queryForm.dsName,f.tableName).then(oe=>{ie(oe.data.fieldList)&&Fe(n.queryForm.dsName,f.tableName)}).finally(()=>{U.push({path:"/gen/gener/index",query:{tableName:f.tableName,dsName:n.queryForm.dsName}})});var f},text:"",type:"primary"},{default:r(()=>[d(m(l.$t("gen.genBtn")),1)]),_:2},1032,["onClick"]),_((y(),g(c,{icon:"edit-pen",text:"",type:"primary",onClick:b=>e(C).openDialog("edit",o.row.id)},{default:r(()=>[d(m(l.$t("common.editBtn")),1)]),_:2},1032,["onClick"])),[[F,"order_createtable_edit"]]),a(c,{icon:"delete",text:"",type:"primary",onClick:b=>V([o.row.id])},{default:r(()=>[d(m(l.$t("common.delBtn")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data","cell-style","header-cell-style","onSortChange"])),[[te,e(n).loading]]),a(le,_e({onSizeChange:e(J),onCurrentChange:e(j)},e(n).pagination),null,16,["onSizeChange","onCurrentChange"])]),a(e(O),{ref_key:"formDialogRef",ref:C,onRefresh:t[5]||(t[5]=o=>e(u)(!1))},null,512)])}}})});export{Te as __tla,K as default};
