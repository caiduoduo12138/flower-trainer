import{r as $,u}from"./index.0f5ebb0a.js";import{g as j,a as H,t as M}from"./sensitive.e2fa99d9.js";import{l as w,r as c,R as S,aa as s,ah as U,m as _,D as x,E as t,t as W,L as l,I as y,u as r,F as q,j as B,n as N}from"./vue.4dfaac09.js";const z=["innerHTML"],A={class:"dialog-footer"},G=w({name:"SysSensitiveWordDialog"}),J=w({...G,emits:["refresh"],setup(K,{expose:L,emit:T}){const b=T,g=c(),o=c(!1),m=c(!1),p=c(""),n=S({sensitiveId:"",sensitiveWord:""}),V=c({sensitiveWord:[{validator:$.overLength,trigger:"blur"},{required:!0,message:"\u654F\u611F\u8BCD\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),C=async a=>{try{if(a.target.tagName.toLowerCase()==="a"&&a.target.classList.contains("link-error")){const{data:e}=await j({sensitiveWord:a.target.innerText,sensitiveType:"1"});if(e)return void u().error("\u6570\u636E\u5DF2\u5B58\u5728\uFF0C\u8BF7\u52FF\u91CD\u65B0\u6DFB\u52A0");await H({sensitiveWord:a.target.innerText,sensitiveType:"1"}),u().success("\u767D\u540D\u5355\u6DFB\u52A0\u6210\u529F"),b("refresh")}}catch(e){u().error(e.msg)}},h=async()=>{if(!await g.value.validate().catch(()=>{}))return!1;try{m.value=!0;const{data:a}=await M(n);p.value=a,p.value=p.value.map(e=>{let d=e;return a.forEach(i=>{let f=new RegExp(i,"g");d=d.replace(f,`
<div class="tooltip tooltip-open tooltip-bottom" data-tip="\u89E6\u53D1\u654F\u611F\u8BCD">
  <a class="link link-error" @click="$emit('click-child','${i}')">${i}</a>
</div>
    `)}),d}),u().success("\u64CD\u4F5C\u6210\u529F"),b("refresh")}catch(a){u().error(a.msg)}finally{m.value=!1}};return L({openDialog:a=>{o.value=!0,n.sensitiveId="",N(()=>{var e;(e=g.value)==null||e.resetFields()})}}),(a,e)=>{const d=s("el-input"),i=s("el-form-item"),f=s("el-col"),D=s("tip"),R=s("el-row"),E=s("el-form"),k=s("el-button"),F=s("el-dialog"),I=U("loading");return _(),x(F,{title:"\u5339\u914D\u6D4B\u8BD5",modelValue:r(o),"onUpdate:modelValue":e[2]||(e[2]=v=>B(o)?o.value=v:null),"close-on-click-modal":!1,draggable:""},{footer:t(()=>[W("span",A,[l(k,{onClick:e[1]||(e[1]=v=>o.value=!1)},{default:t(()=>[y("\u53D6\u6D88")]),_:1}),l(k,{type:"primary",onClick:h,disabled:r(m)},{default:t(()=>[y("\u786E\u8BA4")]),_:1},8,["disabled"])])]),default:t(()=>[q((_(),x(E,{ref_key:"dataFormRef",ref:g,model:r(n),rules:r(V),formDialogRef:"","label-width":"90px"},{default:t(()=>[l(R,{gutter:24},{default:t(()=>[l(f,{span:24,class:"mb20"},{default:t(()=>[l(i,{label:"\u654F\u611F\u8BCD",prop:"sensitiveWord"},{default:t(()=>[l(d,{type:"textarea",rows:"3",modelValue:r(n).sensitiveWord,"onUpdate:modelValue":e[0]||(e[0]=v=>r(n).sensitiveWord=v),placeholder:"\u8BF7\u8F93\u5165\u654F\u611F\u8BCD",onBlur:h},null,8,["modelValue"])]),_:1})]),_:1}),l(f,{span:24,class:"mb20"},{default:t(()=>[l(i,{prop:"result"},{label:t(()=>[y(" \u5339\u914D\u7ED3\u679C "),l(D,{content:"\u53EF\u70B9\u51FB\u654F\u611F\u8BCD\u52A0\u5165\u767D\u540D\u5355"})]),default:t(()=>[W("div",{innerHTML:r(p),onClick:C},null,8,z)]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[I,r(m)]])]),_:1},8,["modelValue"])}}});export{J as default};
