import{v as D}from"./index.c33ef0ff.js";import{r as y,u as V}from"./index.0f5ebb0a.js";import{g as S}from"./config.08f63081.js";import{h as w}from"./message.4096306f.js";import{l as v,r as n,R as F,aa as s,ah as O,m as _,D as h,E as t,t as q,L as o,I as f,u as l,F as z,j as E,n as J}from"./vue.4dfaac09.js";const T={class:"dialog-footer"},I=v({name:"SmsSenderDialog"}),L=v({...I,emits:["refresh"],setup(P,{expose:N,emit:A}){const p=n(),m=n(!1),i=n(!1),e=F({configType:"sms",configKey:"sms",configName:"",mobiles:[],bizCode:"",id:"",params:{},data:`{
    "code": "1234"
}`}),j=n({data:[{required:!0,message:"\u53C2\u6570\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:y.json,trigger:"blur"}],mobiles:[{required:!0,message:"\u624B\u673A\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:y.validatePhone,trigger:"blur"}]}),K=async()=>{if(!await p.value.validate().catch(()=>{}))return!1;try{i.value=!0,e.params=JSON.parse(e.data),await w(e),V().success("\u53D1\u9001\u6210\u529F")}catch(r){V().error(r.msg)}finally{e.data=JSON.stringify(e.params),i.value=!1}},U=r=>{i.value=!0,S({id:r}).then(a=>{Object.assign(e,a.data[0]),e.bizCode=e.configKey}).finally(()=>{i.value=!1})};return N({openDialog:r=>{m.value=!0,e.id="",J(()=>{var a;(a=p.value)==null||a.resetFields()}),r&&(e.id=r,U(r))}}),(r,a)=>{const g=s("el-input"),u=s("el-form-item"),c=s("tip"),k=s("tag-list"),x=s("el-form"),b=s("el-button"),C=s("el-dialog"),R=O("loading");return _(),h(C,{title:"\u77ED\u4FE1\u53D1\u9001\u6D4B\u8BD5",modelValue:l(m),"onUpdate:modelValue":a[5]||(a[5]=d=>E(m)?m.value=d:null),"close-on-click-modal":!1,draggable:""},{footer:t(()=>[q("span",T,[o(b,{onClick:a[4]||(a[4]=d=>m.value=!1)},{default:t(()=>[f("\u53D6\u6D88")]),_:1}),o(b,{type:"primary",onClick:K,disabled:l(i)},{default:t(()=>[f("\u786E\u8BA4")]),_:1},8,["disabled"])])]),default:t(()=>[z((_(),h(x,{ref_key:"dataFormRef",ref:p,model:l(e),rules:l(j),formDialogRef:"","label-width":"100px"},{default:t(()=>[o(u,{label:"\u4E1A\u52A1\u540D\u79F0",prop:"configName"},{default:t(()=>[o(g,{modelValue:l(e).configName,"onUpdate:modelValue":a[0]||(a[0]=d=>l(e).configName=d),placeholder:"\u8BF7\u8F93\u5165\u4E1A\u52A1\u540D\u79F0",disabled:""},null,8,["modelValue"])]),_:1}),o(u,{label:"\u4E1A\u52A1\u7F16\u7801",prop:"configKey"},{label:t(()=>[f("\u4E1A\u52A1\u7F16\u7801 "),o(c,{content:"\u4EE3\u7801\u4E2D\u901A\u8FC7\u4E1A\u52A1\u7F16\u7801\u53D1\u9001"})]),default:t(()=>[o(g,{modelValue:l(e).configKey,"onUpdate:modelValue":a[1]||(a[1]=d=>l(e).configKey=d),placeholder:"\u8BF7\u8F93\u5165\u4E1A\u52A1\u7F16\u7801",disabled:""},null,8,["modelValue"])]),_:1}),o(u,{label:"\u63A5\u6536\u624B\u673A\u53F7",prop:"mobiles"},{default:t(()=>[o(k,{modelValue:l(e).mobiles,"onUpdate:modelValue":a[2]||(a[2]=d=>l(e).mobiles=d),buttonText:"+\u624B\u673A\u53F7"},null,8,["modelValue"])]),_:1}),o(u,{prop:"data"},{label:t(()=>[f("\u53C2\u6570 "),o(c,{content:"\u53C2\u8003\u77ED\u4FE1\u6A21\u677F\u53C2\u6570\u914D\u7F6E  "})]),default:t(()=>[o(l(D),{ref:"jsonEditorRef",modelValue:l(e).data,"onUpdate:modelValue":a[3]||(a[3]=d=>l(e).data=d)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[R,l(i)]])]),_:1},8,["modelValue"])}}});export{L as default};
