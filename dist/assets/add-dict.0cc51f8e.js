import{d as K,r as V,P as N,T as O,M as S,u as x}from"./index.0f5ebb0a.js";import{u as A}from"./dict.10eb31b5.js";import{l as k,r as g,R as F,aa as i,ah as G,m as y,D as T,E as d,t as H,L as a,I as _,J as w,u as t,F as Q,q as W,K as X,$ as Y,j as Z,n as ee}from"./vue.4dfaac09.js";const le={class:"dialog-footer"},ae=k({name:"systemDicDialog"}),te=k({...ae,emits:["refresh"],setup(oe,{expose:I,emit:U}){const D=U,{dict_type:C}=A("dict_type"),{t:c}=K(),f=g(),s=g(!1),m=g(!1);g({});const o=F({id:"",dictType:"",description:"",systemFlag:"0",remarks:"",columns:[]}),q=F({dictType:[{validator:V.overLength,trigger:"blur"},{required:!0,message:"\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:V.validatorNameCn,trigger:"blur"},{validator:(l,r,h)=>{N(l,r,h,o.id!=="")},trigger:"blur"}],systemFlag:[{required:!0,message:"\u5B57\u5178\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],description:[{validator:V.overLength,trigger:"blur"},{required:!0,message:"\u63CF\u8FF0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],columns:[{required:!0,message:"\u5B57\u5178\u9879\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),L=async()=>{if(!await f.value.validate().catch(()=>{}))return!1;try{m.value=!0;const{data:l}=await O(o);o.columns.forEach(async r=>{r.dictId=l.id,r.dictType=o.dictType,await S(r)}),x().success(c("common.addSuccessText")),s.value=!1,D("refresh",o.dictType)}catch(l){x().error(l.msg)}finally{m.value=!1}};let z=1;const B=()=>{o.columns.push({sortOrder:""+z++})};return I({openDialog:()=>{s.value=!0,o.id="",ee(()=>{var l;(l=f.value)==null||l.resetFields()})}}),(l,r)=>{const h=i("el-radio"),E=i("el-radio-group"),n=i("el-form-item"),p=i("el-input"),b=i("el-button"),v=i("el-table-column"),M=i("el-table"),P=i("el-col"),j=i("el-form"),R=i("el-dialog"),J=G("loading");return y(),T(R,{title:"\u65B0\u589E\u5B57\u5178",modelValue:t(s),"onUpdate:modelValue":r[4]||(r[4]=e=>Z(s)?s.value=e:null),width:"600"},{footer:d(()=>[H("span",le,[a(b,{onClick:r[3]||(r[3]=e=>s.value=!1)},{default:d(()=>[_(w(l.$t("common.cancelButtonText")),1)]),_:1}),a(b,{onClick:L,type:"primary",disabled:t(m)},{default:d(()=>[_(w(l.$t("common.confirmButtonText")),1)]),_:1},8,["disabled"])])]),default:d(()=>[Q((y(),T(j,{model:t(o),rules:t(q),"label-width":"100px",ref_key:"dicDialogFormRef",ref:f},{default:d(()=>[a(n,{label:l.$t("sysdict.systemFlag"),prop:"systemFlag"},{default:d(()=>[a(E,{modelValue:t(o).systemFlag,"onUpdate:modelValue":r[0]||(r[0]=e=>t(o).systemFlag=e)},{default:d(()=>[(y(!0),W(X,null,Y(t(C),(e,u)=>(y(),T(h,{border:"",key:u,label:e.value},{default:d(()=>[_(w(e.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"]),a(n,{label:l.$t("sysdict.dictType"),prop:"dictType"},{default:d(()=>[a(p,{placeholder:l.$t("sysdict.inputDictTypeTip"),disabled:t(o).id!=="",clearable:"",modelValue:t(o).dictType,"onUpdate:modelValue":r[1]||(r[1]=e=>t(o).dictType=e)},null,8,["placeholder","disabled","modelValue"])]),_:1},8,["label"]),a(n,{label:l.$t("sysdict.description"),prop:"description"},{default:d(()=>[a(p,{placeholder:l.$t("sysdict.inputDescriptionTip"),clearable:"",modelValue:t(o).description,"onUpdate:modelValue":r[2]||(r[2]=e=>t(o).description=e)},null,8,["placeholder","modelValue"])]),_:1},8,["label"]),a(P,{span:24,class:"mb20"},{default:d(()=>[a(n,{label:t(c)("dictItem.name"),prop:"columns"},{default:d(()=>[a(M,{data:t(o).columns,border:"",style:{width:"100%"},"max-height":"500"},{default:d(()=>[a(v,{type:"index",label:t(c)("createTable.index"),width:"50"},{header:d(()=>[a(b,{icon:"Plus",size:"small",type:"primary",circle:"",onClick:B})]),default:d(e=>[a(b,{icon:"Minus",size:"small",type:"danger",circle:"",onClick:u=>{return $=e.$index,e.row,void o.columns.splice($,1);var $}},null,8,["onClick"])]),_:1},8,["label"]),a(v,{prop:"label",label:l.$t("dictItem.label"),"show-overflow-tooltip":""},{default:d(e=>[a(p,{modelValue:e.row.label,"onUpdate:modelValue":u=>e.row.label=u,placeholder:t(c)("dictItem.inputLabelTip")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["label"]),a(v,{prop:"value",label:l.$t("dictItem.itemValue"),"show-overflow-tooltip":""},{default:d(e=>[a(p,{modelValue:e.row.value,"onUpdate:modelValue":u=>e.row.value=u,placeholder:t(c)("dictItem.inputItemValueTip")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["data"])]),_:1},8,["label"])]),_:1})]),_:1},8,["model","rules"])),[[J,t(m)]])]),_:1},8,["modelValue"])}}});export{te as default};
