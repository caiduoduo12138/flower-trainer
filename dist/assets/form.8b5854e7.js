import{u as H}from"./dict.10eb31b5.js";import{r as k,u as y}from"./index.0f5ebb0a.js";import{v as M,p as $,a as z,g as A}from"./config.08f63081.js";import{l as _,r as c,R as B,aa as n,ah as G,m as f,D as p,E as i,t as P,L as u,I as m,u as o,F as Q,q as h,K as I,$ as D,J as W,j as X,n as Y}from"./vue.4dfaac09.js";const Z={class:"dialog-footer"},ee=_({name:"SysMessageHookDialog"}),le=_({...ee,emits:["refresh"],setup(ae,{expose:S,emit:U}){const N=U,V=c(),r=c(!1),s=c(!1),{yes_no_type:w}=H("yes_no_type"),b=c([{value:"ding_talk",label:"\u9489\u9489"},{value:"byte_talk",label:"\u98DE\u4E66"},{value:"we_talk",label:"\u4F01\u5FAE"}]),e=B({configType:"webhook",id:"",configKey:"",configName:"",configValue:{tokenId:void 0,sign:void 0,supplier:""},configStatus:"1"}),K=c({configName:[{required:!0,message:"\u4E1A\u52A1\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:k.overLength,trigger:"blur"}],configKey:[{required:!0,message:"\u4E1A\u52A1\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:k.validatorCapital,trigger:"blur"},{validator:(t,l,d)=>{M(t,l,d,e.id!=="")},trigger:"blur"}],"configValue.supplier":[{required:!0,message:"\u5382\u5546\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],"configValue.tokenId":[{required:!0,message:"Token ID  \u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),q=async()=>{var t,l;if(!await V.value.validate().catch(()=>{}))return!1;try{s.value=!0,(t=e.configValue.tokenId)!=null&&t.includes("******")&&(e.configValue.tokenId=void 0),(l=e.configValue.sign)!=null&&l.includes("******")&&(e.configValue.sign=void 0),e.configValue=JSON.stringify(e.configValue),e.id?await $(e):await z(e),y().success(e.id?"\u4FEE\u6539\u6210\u529F":"\u6DFB\u52A0\u6210\u529F"),r.value=!1,N("refresh")}catch(d){y().error(d.msg)}finally{s.value=!1}},T=t=>{s.value=!0,A({id:t}).then(l=>{Object.assign(e,l.data[0]),e.configValue=JSON.parse(l.data[0].configValue),e.configValue.tokenId="******",e.configValue.sign="******"}).finally(()=>{s.value=!1})};return S({openDialog:t=>{r.value=!0,e.id="",Y(()=>{var l;(l=V.value)==null||l.resetFields()}),t&&(e.id=t,T(t))},supplierList:b}),(t,l)=>{const d=n("el-input"),g=n("el-form-item"),x=n("tip"),C=n("el-option"),F=n("el-select"),J=n("el-radio"),L=n("el-radio-group"),R=n("el-form"),v=n("el-button"),j=n("el-dialog"),O=G("loading");return f(),p(j,{title:o(e).id?"\u7F16\u8F91":"\u65B0\u589E",modelValue:o(r),"onUpdate:modelValue":l[7]||(l[7]=a=>X(r)?r.value=a:null),"close-on-click-modal":!1,draggable:""},{footer:i(()=>[P("span",Z,[u(v,{onClick:l[6]||(l[6]=a=>r.value=!1)},{default:i(()=>[m("\u53D6\u6D88")]),_:1}),u(v,{type:"primary",onClick:q,disabled:o(s)},{default:i(()=>[m("\u786E\u8BA4")]),_:1},8,["disabled"])])]),default:i(()=>[Q((f(),p(R,{ref_key:"dataFormRef",ref:V,model:o(e),rules:o(K),formDialogRef:"","label-width":"100px"},{default:i(()=>[u(g,{label:"\u4E1A\u52A1\u540D\u79F0",prop:"configName"},{default:i(()=>[u(d,{modelValue:o(e).configName,"onUpdate:modelValue":l[0]||(l[0]=a=>o(e).configName=a),placeholder:"\u8BF7\u8F93\u5165\u4E1A\u52A1\u540D\u79F0"},null,8,["modelValue"])]),_:1}),u(g,{label:"\u4E1A\u52A1\u7F16\u7801",prop:"configKey"},{label:i(()=>[m("\u4E1A\u52A1\u7F16\u7801 "),u(x,{content:"\u4EE3\u7801\u4E2D\u901A\u8FC7\u4E1A\u52A1\u7F16\u7801\u53D1\u9001"})]),default:i(()=>[u(d,{modelValue:o(e).configKey,"onUpdate:modelValue":l[1]||(l[1]=a=>o(e).configKey=a),placeholder:"\u8BF7\u8F93\u5165\u4E1A\u52A1\u7F16\u7801"},null,8,["modelValue"])]),_:1}),u(g,{label:"\u4E91\u5382\u5546",prop:"configValue.supplier"},{default:i(()=>[u(F,{modelValue:o(e).configValue.supplier,"onUpdate:modelValue":l[2]||(l[2]=a=>o(e).configValue.supplier=a),placeholder:"\u8BF7\u9009\u62E9\u4E91\u5382\u5546"},{default:i(()=>[(f(!0),h(I,null,D(o(b),a=>(f(),p(C,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),u(g,{label:"Token ID",prop:"configValue.tokenId"},{default:i(()=>[u(d,{modelValue:o(e).configValue.tokenId,"onUpdate:modelValue":l[3]||(l[3]=a=>o(e).configValue.tokenId=a),placeholder:"\u8BF7\u8F93\u5165Token ID"},null,8,["modelValue"])]),_:1}),u(g,{label:"\u7B7E\u540D",prop:"configValue.sign"},{default:i(()=>[u(d,{modelValue:o(e).configValue.sign,"onUpdate:modelValue":l[4]||(l[4]=a=>o(e).configValue.sign=a),placeholder:"\u8BF7\u8F93\u5165\u7B7E\u540D"},null,8,["modelValue"])]),_:1}),u(g,{label:"\u542F\u7528\u72B6\u6001",prop:"configStatus"},{default:i(()=>[u(L,{modelValue:o(e).configStatus,"onUpdate:modelValue":l[5]||(l[5]=a=>o(e).configStatus=a)},{default:i(()=>[(f(!0),h(I,null,D(o(w),(a,E)=>(f(),p(J,{key:E,label:a.value,border:""},{default:i(()=>[m(W(a.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])),[[O,o(s)]])]),_:1},8,["title","modelValue"])}}});export{le as default};
