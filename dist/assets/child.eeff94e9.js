import{c as L,d as U,a as O}from"./table.a96d0687.js";import{u as z}from"./index.0f5ebb0a.js";import{l as x,r as m,R as G,e as H,h as M,aa as o,m as r,D as p,E as a,t as P,L as t,I as c,J as Q,u,q as g,K as V,$ as _,j as S}from"./vue.4dfaac09.js";const W={class:"dialog-footer"},X=x({name:"child"}),Y=x({...X,props:{modelValue:Object},emits:["update:modelValue"],setup(Z,{expose:C,emit:j}){const w=j,n=m(!1),N=m(),d=G({childTableName:"",mainField:"",childField:""}),D=m({childTableName:[{required:!0,message:"\u8BF7\u9009\u62E9\u5B50\u8868",trigger:"blur"}],mainField:[{required:!0,message:"\u8BF7\u9009\u62E9\u5173\u8054\u5B57\u6BB5",trigger:"blur"}],childField:[{required:!0,message:"\u8BF7\u9009\u62E9\u5173\u8054\u5B57\u6BB5",trigger:"blur"}]}),T=m(),k=m(),y=m(),f=m(""),R=l=>{L(l).then(i=>{T.value=i.data})},$=(l,i)=>{U(l,i).then(s=>{y.value=s.data})},B=l=>{d.childField="",U(f.value,l).then(i=>{k.value=i.data})},E=async()=>{if(!await N.value.validate().catch(()=>{}))return!1;O(f.value,d.childTableName).then(()=>{z().success("\u5B50\u8868\u4FE1\u606F\u540C\u6B65\u6210\u529F")}),n.value=!1},I=()=>{d.childTableName="",d.mainField="",d.childField="",n.value=!1};return H(()=>d,l=>{w("update:modelValue",l)},{deep:!0,immediate:!0}),M(()=>{}),C({openDialog:l=>{f.value=l.dsName,n.value=!0,R(l.dsName),$(l.dsName,l.tableName),l.childTableName&&(d.childTableName=l.childTableName,d.mainField=l.mainField,d.childField=l.childField)}}),(l,i)=>{const s=o("tip"),h=o("el-option"),b=o("el-select"),v=o("el-form-item"),F=o("el-col"),A=o("el-row"),J=o("el-form"),q=o("el-button"),K=o("el-dialog");return r(),p(K,{"close-on-click-modal":!1,title:"\u5B50\u8868\u914D\u7F6E",draggable:"",modelValue:u(n),"onUpdate:modelValue":i[3]||(i[3]=e=>S(n)?n.value=e:null)},{footer:a(()=>[P("span",W,[t(q,{onClick:I},{default:a(()=>[c("\u6E05\u7A7A")]),_:1}),t(q,{onClick:E,type:"primary"},{default:a(()=>[c(Q(l.$t("common.confirmButtonText")),1)]),_:1})])]),default:a(()=>[t(J,{model:u(d),rules:u(D),ref_key:"dataFormRef",ref:N},{default:a(()=>[t(A,{gutter:35},{default:a(()=>[t(F,{span:8},{default:a(()=>[t(v,{prop:"childTableName"},{label:a(()=>[c(" \u5B50\u8868\u540D"),t(s,{content:"\u5173\u8054\u8868\u7684\u5B50\u8868\uFF0C\u4F8B\u5982\u4E00\u5BF9\u591A\u4E2D\u7684\u5B58\u50A8\u591A\u4FE1\u606F\u7684\u8868"})]),default:a(()=>[t(b,{placeholder:"\u8BF7\u9009\u62E9\u5B50\u8868",modelValue:u(d).childTableName,"onUpdate:modelValue":i[0]||(i[0]=e=>u(d).childTableName=e),filterable:"",onChange:B},{default:a(()=>[(r(!0),g(V,null,_(u(T),e=>(r(),p(h,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(F,{span:8},{default:a(()=>[t(v,{prop:"mainField"},{label:a(()=>[c(" \u4E3B\u8868\u5B57\u6BB5"),t(s,{content:"\u4E00\u822C\u4E3A\u4E3B\u8868\u7684\u4E3B\u952E\u5B57\u6BB5"})]),default:a(()=>[t(b,{placeholder:"\u8BF7\u9009\u5173\u8054\u5B57\u6BB5",modelValue:u(d).mainField,"onUpdate:modelValue":i[1]||(i[1]=e=>u(d).mainField=e),filterable:""},{default:a(()=>[(r(!0),g(V,null,_(u(y),e=>(r(),p(h,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(F,{span:8},{default:a(()=>[t(v,{prop:"childField"},{label:a(()=>[c(" \u5B50\u8868\u5B57\u6BB5"),t(s,{content:"\u5B50\u8868\u4E2D\u5BF9\u5E94\u4E3B\u8868\u4E3B\u952E\u7684\u5173\u8054\u5B57\u6BB5"})]),default:a(()=>[t(b,{placeholder:"\u8BF7\u9009\u5173\u8054\u5B57\u6BB5",modelValue:u(d).childField,"onUpdate:modelValue":i[2]||(i[2]=e=>u(d).childField=e),filterable:""},{default:a(()=>[(r(!0),g(V,null,_(u(k),e=>(r(),p(h,{key:e,label:e,value:e},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])}}});export{Y as default};
