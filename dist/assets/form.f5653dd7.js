import{d as j,r as C,a7 as L,u as h,a8 as R,a9 as S,aa as E}from"./index.0f5ebb0a.js";import{l as b,r as p,R as J,aa as n,ah as z,m as y,D as v,E as s,t as A,L as o,I,J as V,u as t,F as G,j as H,n as K}from"./vue.4dfaac09.js";const M={class:"dialog-footer"},N=b({name:"systemDeptDialog"}),P=b({...N,emits:["refresh"],setup(Q,{expose:$,emit:x}){const O=x,{t:_}=j(),m=p(),l=J({parentId:"",deptId:"",name:"",sortOrder:9999}),c=p([]),u=p(!1),i=p(!1),T=p({parentId:[{required:!0,message:"\u4E0A\u7EA7\u90E8\u95E8\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],name:[{validator:C.overLength,trigger:"blur"},{required:!0,message:"\u90E8\u95E8\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],sortOrder:[{required:!0,message:"\u6392\u5E8F\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),w=async()=>{if(!await m.value.validate().catch(()=>{}))return!1;try{i.value=!0,l.deptId?await R(l):await S(l),h().success(_(l.deptId?"common.editSuccessText":"common.addSuccessText")),u.value=!1,O("refresh")}catch(e){h().error(e.msg)}finally{i.value=!1}},D=async()=>{E().then(e=>{c.value=[];const a={id:"0",name:"\u6839\u90E8\u95E8",children:[]};a.children=e.data,c.value.push(a)})};return $({openDialog:(e,a)=>{u.value=!0,l.deptId="",K(()=>{var r;(r=m.value)==null||r.resetFields(),l.parentId=a}),e==="edit"&&L(a).then(r=>{Object.assign(l,r.data)}).catch(r=>{h().error(r.msg)}),D()}}),(e,a)=>{const r=n("el-tree-select"),f=n("el-form-item"),k=n("el-input"),B=n("el-input-number"),U=n("el-form"),g=n("el-button"),q=n("el-dialog"),F=z("loading");return y(),v(q,{title:t(l).deptId?e.$t("common.editBtn"):e.$t("common.addBtn"),modelValue:t(u),"onUpdate:modelValue":a[4]||(a[4]=d=>H(u)?u.value=d:null),width:"600"},{footer:s(()=>[A("span",M,[o(g,{onClick:a[3]||(a[3]=d=>u.value=!1)},{default:s(()=>[I(V(e.$t("common.cancelButtonText")),1)]),_:1}),o(g,{type:"primary",onClick:w,disabled:t(i)},{default:s(()=>[I(V(e.$t("common.confirmButtonText")),1)]),_:1},8,["disabled"])])]),default:s(()=>[G((y(),v(U,{ref_key:"deptDialogFormRef",ref:m,model:t(l),"label-width":"90px",rules:t(T)},{default:s(()=>[o(f,{label:e.$t("sysdept.parentId"),prop:"parentId"},{default:s(()=>[o(r,{modelValue:t(l).parentId,"onUpdate:modelValue":a[0]||(a[0]=d=>t(l).parentId=d),data:t(c),props:{value:"id",label:"name",children:"children"},class:"w100",clearable:"","check-strictly":"","render-after-expand":!1,placeholder:e.$t("sysdept.inputparentIdTip")},null,8,["modelValue","data","placeholder"])]),_:1},8,["label"]),o(f,{label:e.$t("sysdept.name"),prop:"name"},{default:s(()=>[o(k,{modelValue:t(l).name,"onUpdate:modelValue":a[1]||(a[1]=d=>t(l).name=d),placeholder:e.$t("sysdept.inputnameTip"),clearable:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(f,{label:e.$t("sysdept.sortOrder"),prop:"sortOrder"},{default:s(()=>[o(B,{modelValue:t(l).sortOrder,"onUpdate:modelValue":a[2]||(a[2]=d=>t(l).sortOrder=d),placeholder:e.$t("sysdept.inputsortOrderTip"),clearable:""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},8,["model","rules"])),[[F,t(i)]])]),_:1},8,["title","modelValue"])}}});export{P as default};
