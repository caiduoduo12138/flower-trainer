import{u as $}from"./dict.10eb31b5.js";import{r as K,u as A}from"./index.0f5ebb0a.js";import{v as I,p as z,a as B,g as G}from"./config.08f63081.js";import{l as D,r as _,R as P,aa as r,ah as Q,m as i,D as V,E as o,t as W,L as a,I as m,u as t,F as X,q as w,K as U,$ as k,J as L,j as Y,n as Z}from"./vue.4dfaac09.js";const ee={class:"dialog-footer"},ae=D({name:"SysMessageEmailDialog"}),le=D({...ae,emits:["refresh"],setup(oe,{expose:J,emit:j}){const x=j,v=_(),g=_(!1),p=_(!1),{yes_no_type:h}=$("yes_no_type"),e=P({configType:"email",id:"",configKey:"",configName:"",configValue:{port:456,smtpServer:"",username:"",password:void 0,isSSL:"1",isAuth:"1",html:""},configStatus:"1"}),C=_({configName:[{required:!0,message:"\u4E1A\u52A1\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:K.overLength,trigger:"blur"}],configKey:[{required:!0,message:"\u4E1A\u52A1\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:K.validatorCapital,trigger:"blur"},{validator:(d,l,n)=>{I(d,l,n,e.id!=="")},trigger:"blur"}],"configValue.smtpServer":[{required:!0,message:"smtp server \u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],"configValue.port":[{required:!0,message:"\u7AEF\u53E3\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],"configValue.username":[{required:!0,message:"\u7528\u6237\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),F=async()=>{var d;if(!await v.value.validate().catch(()=>{}))return!1;try{p.value=!0,(d=e.configValue.password)!=null&&d.includes("******")&&(e.configValue.password=void 0),e.configValue=JSON.stringify(e.configValue),e.id?await z(e):await B(e),A().success(e.id?"\u4FEE\u6539\u6210\u529F":"\u6DFB\u52A0\u6210\u529F"),g.value=!1,x("refresh")}catch(l){A().error(l.msg)}finally{p.value=!1}},R=d=>{p.value=!0,G({id:d}).then(l=>{Object.assign(e,l.data[0]),e.configValue=JSON.parse(l.data[0].configValue),e.configValue.password="******"}).finally(()=>{p.value=!1})};return J({openDialog:d=>{g.value=!0,e.id="",Z(()=>{var l;(l=v.value)==null||l.resetFields()}),d&&(e.id=d,R(d))}}),(d,l)=>{const n=r("el-input"),s=r("el-form-item"),N=r("tip"),O=r("el-input-number"),f=r("el-col"),y=r("el-radio"),S=r("el-radio-group"),b=r("el-row"),E=r("editor"),H=r("el-form"),q=r("el-button"),M=r("el-dialog"),T=Q("loading");return i(),V(M,{title:t(e).id?"\u7F16\u8F91":"\u65B0\u589E",modelValue:t(g),"onUpdate:modelValue":l[11]||(l[11]=u=>Y(g)?g.value=u:null),"close-on-click-modal":!1,draggable:""},{footer:o(()=>[W("span",ee,[a(q,{onClick:l[10]||(l[10]=u=>g.value=!1)},{default:o(()=>[m("\u53D6\u6D88")]),_:1}),a(q,{type:"primary",onClick:F,disabled:t(p)},{default:o(()=>[m("\u786E\u8BA4")]),_:1},8,["disabled"])])]),default:o(()=>[X((i(),V(H,{ref_key:"dataFormRef",ref:v,model:t(e),rules:t(C),formDialogRef:"","label-width":"100px"},{default:o(()=>[a(s,{label:"\u4E1A\u52A1\u540D\u79F0",prop:"configName"},{default:o(()=>[a(n,{modelValue:t(e).configName,"onUpdate:modelValue":l[0]||(l[0]=u=>t(e).configName=u),placeholder:"\u8BF7\u8F93\u5165\u4E1A\u52A1\u540D\u79F0"},null,8,["modelValue"])]),_:1}),a(s,{label:"\u4E1A\u52A1\u7F16\u7801",prop:"configKey"},{label:o(()=>[m("\u4E1A\u52A1\u7F16\u7801 "),a(N,{content:"\u4EE3\u7801\u4E2D\u901A\u8FC7\u4E1A\u52A1\u7F16\u7801\u53D1\u9001"})]),default:o(()=>[a(n,{modelValue:t(e).configKey,"onUpdate:modelValue":l[1]||(l[1]=u=>t(e).configKey=u),placeholder:"\u8BF7\u8F93\u5165\u4E1A\u52A1\u7F16\u7801"},null,8,["modelValue"])]),_:1}),a(s,{label:"\u670D\u52A1\u5730\u5740",prop:"configValue.smtpServer"},{default:o(()=>[a(n,{modelValue:t(e).configValue.smtpServer,"onUpdate:modelValue":l[2]||(l[2]=u=>t(e).configValue.smtpServer=u),placeholder:"\u8BF7\u8F93\u5165\u670D\u52A1\u5730\u5740"},null,8,["modelValue"])]),_:1}),a(b,null,{default:o(()=>[a(f,{span:12,class:"mb20"},{default:o(()=>[a(s,{label:"\u670D\u52A1\u7AEF\u53E3",prop:"configValue.port"},{default:o(()=>[a(O,{modelValue:t(e).configValue.port,"onUpdate:modelValue":l[3]||(l[3]=u=>t(e).configValue.port=u),placeholder:"\u8BF7\u8F93\u5165\u7AEF\u53E3"},null,8,["modelValue"])]),_:1})]),_:1}),a(f,{span:12,class:"mb20"},{default:o(()=>[a(s,{label:"\u5F00\u542FSSL",prop:"configValue.isSSL"},{default:o(()=>[a(S,{modelValue:t(e).configValue.isSSL,"onUpdate:modelValue":l[4]||(l[4]=u=>t(e).configValue.isSSL=u)},{default:o(()=>[(i(!0),w(U,null,k(t(h),(u,c)=>(i(),V(y,{key:c,label:u.value,border:""},{default:o(()=>[m(L(u.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(b,null,{default:o(()=>[a(f,{span:12,class:"mb20"},{default:o(()=>[a(s,{label:"\u7528\u6237\u540D",prop:"configValue.username"},{default:o(()=>[a(n,{modelValue:t(e).configValue.username,"onUpdate:modelValue":l[5]||(l[5]=u=>t(e).configValue.username=u),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"},null,8,["modelValue"])]),_:1})]),_:1}),a(f,{span:12,class:"mb20"},{default:o(()=>[a(s,{label:"\u5BC6\u7801",prop:"configValue.password"},{default:o(()=>[a(n,{modelValue:t(e).configValue.password,"onUpdate:modelValue":l[6]||(l[6]=u=>t(e).configValue.password=u),placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF08\u6388\u6743\u7801\uFF09"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(b,null,{default:o(()=>[a(f,{span:12,class:"mb20"},{default:o(()=>[a(s,{label:"\u5F00\u542F\u8BA4\u8BC1",prop:"configValue.isAuth"},{default:o(()=>[a(S,{modelValue:t(e).configValue.isAuth,"onUpdate:modelValue":l[7]||(l[7]=u=>t(e).configValue.isAuth=u)},{default:o(()=>[(i(!0),w(U,null,k(t(h),(u,c)=>(i(),V(y,{key:c,label:u.value,border:""},{default:o(()=>[m(L(u.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),a(f,{span:12,class:"mb20"},{default:o(()=>[a(s,{label:"\u542F\u7528\u72B6\u6001",prop:"configStatus"},{default:o(()=>[a(S,{modelValue:t(e).configStatus,"onUpdate:modelValue":l[8]||(l[8]=u=>t(e).configStatus=u)},{default:o(()=>[(i(!0),w(U,null,k(t(h),(u,c)=>(i(),V(y,{key:c,label:u.value,border:""},{default:o(()=>[m(L(u.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),a(b,null,{default:o(()=>[a(f,{span:24,class:"mb20"},{default:o(()=>[a(s,{prop:"content"},{label:o(()=>[m("\u90AE\u4EF6\u6A21\u677F "),a(N,{content:"\u90AE\u4EF6\u6A21\u677F \u4F7F\u7528 ${key} \u5360\u4F4D\u7B26\uFF0C\u5982\u679C\u6A21\u677F\u4E3A\u7A7A\uFF0C\u5219\u76F4\u63A5\u63A8\u9001body"})]),default:o(()=>[a(E,{"get-html":t(e).configValue.html,"onUpdate:getHtml":l[9]||(l[9]=u=>t(e).configValue.html=u),placeholder:"\u8BF7\u8F93\u5165HTML\u5185\u5BB9"},null,8,["get-html"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])),[[T,t(p)]])]),_:1},8,["title","modelValue"])}}});export{le as default};
