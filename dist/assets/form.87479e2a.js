import{d as G,r as g,u as k}from"./index.0f5ebb0a.js";import{p as M,a as P,g as Q}from"./datasource.a0355933.js";import{u as W}from"./dict.10eb31b5.js";import{l as q,r as _,R as X,aa as u,ah as Y,m as n,D as m,E as r,t as Z,L as s,I as V,J as v,u as e,F as ee,q as U,K as x,$ as N,H as b,j as ae,n as le}from"./vue.4dfaac09.js";const oe={class:"dialog-footer"},re=q({name:"systemDatasourceConfDialog"}),se=q({...re,emits:["refresh"],setup(de,{expose:L,emit:D}){const $=D,{t:d}=G(),T=_(),f=_(!1),y=_(!1),{ds_config_type:j,ds_type:B}=W("ds_config_type","ds_type"),a=X({id:"",name:"",url:"",username:"",password:void 0,createTime:"",updateTime:"",dsType:"",confType:0,dsName:"",instance:"",port:3306,host:""}),R=_({name:[{required:!0,message:"\u522B\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:(t,l,h)=>{l&&!/(?=.*[a-z])(?=.*_)/.test(l)?h(new Error("\u6570\u636E\u6E90\u540D\u79F0\u4E0D\u5408\u6CD5, \u7EC4\u540D_\u6570\u636E\u6E90\u540D\u5F62\u5F0F")):h()},trigger:"blur"}],url:[{required:!0,message:"jdbcurl\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{min:10,max:500,message:"URL\u957F\u5EA6\u5FC5\u987B\u4ECB\u4E8E 10 \u548C 500 \u5B57\u7B26\u4E4B\u95F4",trigger:"blur"}],username:[{validator:g.overLength,trigger:"blur"},{required:!0,message:"\u7528\u6237\u540D\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],password:[{validator:g.overLength,trigger:"blur"},{required:!0,message:"\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],dsType:[{required:!0,message:"\u6570\u636E\u5E93\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],confType:[{required:!0,message:"\u914D\u7F6E\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],dsName:[{validator:g.overLength,trigger:"blur"},{required:!0,message:"\u6570\u636E\u5E93\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],instance:[{validator:g.overLength,trigger:"blur"},{required:!0,message:"\u5B9E\u4F8B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],port:[{required:!0,message:"\u7AEF\u53E3\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],host:[{validator:g.overLength,trigger:"blur"},{required:!0,message:"\u4E3B\u673A\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),C=async()=>{var t;if(!await T.value.validate().catch(()=>{}))return!1;a.password=(t=a.password)!=null&&t.includes("******")?void 0:a.password;try{y.value=!0,a.id?await M(a):await P(a),k().success(d(a.id?"common.editSuccessText":"common.addSuccessText")),f.value=!1,$("refresh")}catch(l){k().error(l.msg)}finally{y.value=!1}},F=t=>Q(t).then(l=>{Object.assign(a,l.data)});return L({openDialog:async t=>{f.value=!0,a.id="",le(()=>{var l;(l=T.value)==null||l.resetFields()}),t&&(a.id=t,await F(t),a.password="********")}}),(t,l)=>{const h=u("el-option"),E=u("el-select"),p=u("el-form-item"),c=u("el-col"),i=u("el-input"),H=u("el-radio"),S=u("el-radio-group"),z=u("el-input-number"),I=u("el-row"),J=u("el-form"),w=u("el-button"),K=u("el-dialog"),O=Y("loading");return n(),m(K,{title:e(a).id?t.$t("common.editBtn"):t.$t("common.addBtn"),modelValue:e(f),"onUpdate:modelValue":l[11]||(l[11]=o=>ae(f)?f.value=o:null),"close-on-click-modal":!1,draggable:""},{footer:r(()=>[Z("span",oe,[s(w,{onClick:l[10]||(l[10]=o=>f.value=!1)},{default:r(()=>[V(v(t.$t("common.cancelButtonText")),1)]),_:1}),s(w,{type:"primary",onClick:C,disabled:e(y)},{default:r(()=>[V(v(t.$t("common.confirmButtonText")),1)]),_:1},8,["disabled"])])]),default:r(()=>[ee((n(),m(J,{ref_key:"dataFormRef",ref:T,model:e(a),rules:e(R),formDialogRef:"","label-width":"90px"},{default:r(()=>[s(I,{gutter:20},{default:r(()=>[s(c,{span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(d)("datasourceconf.dsType"),prop:"dsType"},{default:r(()=>[s(E,{modelValue:e(a).dsType,"onUpdate:modelValue":l[0]||(l[0]=o=>e(a).dsType=o),placeholder:e(d)("datasourceconf.inputdsTypeTip")},{default:r(()=>[(n(!0),U(x,null,N(e(B),o=>(n(),m(h,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),s(c,{span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(d)("datasourceconf.name"),prop:"name"},{default:r(()=>[s(i,{modelValue:e(a).name,"onUpdate:modelValue":l[1]||(l[1]=o=>e(a).name=o),placeholder:e(d)("datasourceconf.inputnameTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),s(c,{span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(d)("datasourceconf.username"),prop:"username"},{default:r(()=>[s(i,{modelValue:e(a).username,"onUpdate:modelValue":l[2]||(l[2]=o=>e(a).username=o),placeholder:e(d)("datasourceconf.inputusernameTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),s(c,{span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(d)("datasourceconf.password"),prop:"password"},{default:r(()=>[s(i,{modelValue:e(a).password,"onUpdate:modelValue":l[3]||(l[3]=o=>e(a).password=o),placeholder:e(d)("datasourceconf.inputpasswordTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1}),s(c,{span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(d)("datasourceconf.confType"),prop:"confType"},{default:r(()=>[s(S,{modelValue:e(a).confType,"onUpdate:modelValue":l[4]||(l[4]=o=>e(a).confType=o)},{default:r(()=>[(n(!0),U(x,null,N(e(j),(o,A)=>(n(),m(H,{label:Number(o.value),border:"",key:A},{default:r(()=>[V(v(o.label),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1}),e(a).confType===0&&e(a).dsType==="mssql"?(n(),m(c,{key:0,span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(d)("datasourceconf.instance"),prop:"instance"},{default:r(()=>[s(i,{modelValue:e(a).instance,"onUpdate:modelValue":l[5]||(l[5]=o=>e(a).instance=o),placeholder:e(d)("datasourceconf.inputinstanceTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})):b("",!0),e(a).confType===0?(n(),m(c,{key:1,span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(d)("datasourceconf.port"),prop:"port"},{default:r(()=>[s(z,{modelValue:e(a).port,"onUpdate:modelValue":l[6]||(l[6]=o=>e(a).port=o),placeholder:e(d)("datasourceconf.inputportTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})):b("",!0),e(a).confType===0?(n(),m(c,{key:2,span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(d)("datasourceconf.host"),prop:"host"},{default:r(()=>[s(i,{modelValue:e(a).host,"onUpdate:modelValue":l[7]||(l[7]=o=>e(a).host=o),placeholder:e(d)("datasourceconf.inputhostTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})):b("",!0),e(a).confType===0?(n(),m(c,{key:3,span:12,class:"mb20"},{default:r(()=>[s(p,{label:e(d)("datasourceconf.dsName"),prop:"dsName"},{default:r(()=>[s(i,{modelValue:e(a).dsName,"onUpdate:modelValue":l[8]||(l[8]=o=>e(a).dsName=o),placeholder:e(d)("datasourceconf.inputdsNameTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})):b("",!0),e(a).confType===1?(n(),m(c,{key:4,span:24,class:"mb20"},{default:r(()=>[s(p,{label:e(d)("datasourceconf.url"),prop:"url"},{default:r(()=>[s(i,{modelValue:e(a).url,"onUpdate:modelValue":l[9]||(l[9]=o=>e(a).url=o),type:"textarea",placeholder:e(d)("datasourceconf.inputurlTip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})):b("",!0)]),_:1})]),_:1},8,["model","rules"])),[[O,e(y)]])]),_:1},8,["title","modelValue"])}}});export{se as default};
