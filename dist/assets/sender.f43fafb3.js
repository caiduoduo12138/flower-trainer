import{r as b,u as _}from"./index.0f5ebb0a.js";import{g as H}from"./config.08f63081.js";import{i as z}from"./message.4096306f.js";import{l as h,r as f,R as O,a as S,aa as r,ah as E,m as i,D as n,E as t,t as I,L as s,I as c,u as l,F as J,q as M,K as W,$,H as V,j as B,n as G}from"./vue.4dfaac09.js";const P={class:"dialog-footer"},Q=h({name:"HookSenderDialog"}),X=h({...Q,emits:["refresh"],setup(Y,{expose:T,emit:Z}){const v=f(),m=f(!1),g=f(!1),y=f([{value:"text",label:"\u6587\u672C"},{value:"markdown",label:"Markdown"},{value:"link",label:"\u94FE\u63A5"}]),e=O({configType:"webhook",configKey:"webhook",configName:"",configValue:{supplier:""},bizCode:"",messageType:"text",id:"",messageTitle:"",messageContent:"",noticeAll:"false",messageUrl:"",picUrl:"",phoneList:[]}),w=f({messageType:[{required:!0,message:"\u6D88\u606F\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:b.overLength,trigger:"blur"}],messageTitle:[{required:!0,message:"\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:b.overLength,trigger:"blur"}],messageContent:[{required:!0,message:"\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}],messageUrl:[{required:!0,message:"\u624B\u673A\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:b.overLength,trigger:"blur"}],picUrl:[{required:!0,message:"\u56FE\u7247\u5730\u5740\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:b.overLength,trigger:"blur"}]}),C=S(()=>e.configValue.supplier==="we_talk"?y.value.filter(u=>u.value!=="link"):y.value),L=async()=>{if(!await v.value.validate().catch(()=>{}))return!1;try{g.value=!0,await z(e),_().success("\u53D1\u9001\u6210\u529F")}catch(u){_().error(u.msg)}finally{m.value=!1,g.value=!1}},q=u=>{g.value=!0,H({id:u}).then(a=>{Object.assign(e,a.data[0]),e.configValue=JSON.parse(e.configValue),e.bizCode=e.configKey}).finally(()=>{g.value=!1})};return T({openDialog:u=>{m.value=!0,e.id="",G(()=>{var a;(a=v.value)==null||a.resetFields()}),u&&(e.id=u,q(u))}}),(u,a)=>{const p=r("el-input"),d=r("el-form-item"),x=r("tip"),K=r("el-option"),A=r("el-select"),k=r("el-radio"),N=r("el-radio-group"),D=r("tag-list"),R=r("el-form"),U=r("el-button"),F=r("el-dialog"),j=E("loading");return i(),n(F,{title:"WebHook\u63A8\u9001",modelValue:l(m),"onUpdate:modelValue":a[10]||(a[10]=o=>B(m)?m.value=o:null),"close-on-click-modal":!1,draggable:""},{footer:t(()=>[I("span",P,[s(U,{onClick:a[9]||(a[9]=o=>m.value=!1)},{default:t(()=>[c("\u53D6\u6D88")]),_:1}),s(U,{type:"primary",onClick:L,disabled:l(g)},{default:t(()=>[c("\u786E\u8BA4")]),_:1},8,["disabled"])])]),default:t(()=>[J((i(),n(R,{ref_key:"dataFormRef",ref:v,model:l(e),rules:l(w),formDialogRef:"","label-width":"100px"},{default:t(()=>[s(d,{label:"\u4E1A\u52A1\u540D\u79F0",prop:"configName"},{default:t(()=>[s(p,{modelValue:l(e).configName,"onUpdate:modelValue":a[0]||(a[0]=o=>l(e).configName=o),placeholder:"\u8BF7\u8F93\u5165\u4E1A\u52A1\u540D\u79F0",disabled:""},null,8,["modelValue"])]),_:1}),s(d,{label:"\u4E1A\u52A1\u7F16\u7801",prop:"configKey"},{label:t(()=>[c("\u4E1A\u52A1\u7F16\u7801 "),s(x,{content:"\u4EE3\u7801\u4E2D\u901A\u8FC7\u4E1A\u52A1\u7F16\u7801\u53D1\u9001"})]),default:t(()=>[s(p,{modelValue:l(e).configKey,"onUpdate:modelValue":a[1]||(a[1]=o=>l(e).configKey=o),placeholder:"\u8BF7\u8F93\u5165\u4E1A\u52A1\u7F16\u7801",disabled:""},null,8,["modelValue"])]),_:1}),s(d,{label:"\u6D88\u606F\u7C7B\u578B",prop:"messageType"},{default:t(()=>[s(A,{modelValue:l(e).messageType,"onUpdate:modelValue":a[2]||(a[2]=o=>l(e).messageType=o),placeholder:"\u8BF7\u9009\u62E9\u6D88\u606F\u7C7B\u578B"},{default:t(()=>[(i(!0),M(W,null,$(l(C),o=>(i(),n(K,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(e).messageType==="link"||l(e).messageType==="markdown"?(i(),n(d,{key:0,label:"\u6807\u9898",prop:"messageTitle"},{default:t(()=>[s(p,{modelValue:l(e).messageTitle,"onUpdate:modelValue":a[3]||(a[3]=o=>l(e).messageTitle=o)},null,8,["modelValue"])]),_:1})):V("",!0),s(d,{label:"\u5185\u5BB9",prop:"messageContent"},{default:t(()=>[s(p,{type:"textarea",rows:"5",modelValue:l(e).messageContent,"onUpdate:modelValue":a[4]||(a[4]=o=>l(e).messageContent=o)},null,8,["modelValue"])]),_:1}),l(e).messageType==="link"?(i(),n(d,{key:1,label:"\u6D88\u606F\u94FE\u63A5",prop:"messageUrl"},{default:t(()=>[s(p,{modelValue:l(e).messageUrl,"onUpdate:modelValue":a[5]||(a[5]=o=>l(e).messageUrl=o)},null,8,["modelValue"])]),_:1})):V("",!0),l(e).messageType==="link"?(i(),n(d,{key:2,label:"\u56FE\u7247\u94FE\u63A5",prop:"picUrl"},{default:t(()=>[s(p,{modelValue:l(e).picUrl,"onUpdate:modelValue":a[6]||(a[6]=o=>l(e).picUrl=o)},null,8,["modelValue"])]),_:1})):V("",!0),s(d,{label:"\u901A\u77E5\u5168\u90E8",prop:"noticeAll"},{default:t(()=>[s(N,{modelValue:l(e).noticeAll,"onUpdate:modelValue":a[7]||(a[7]=o=>l(e).noticeAll=o)},{default:t(()=>[s(k,{label:"true",border:""},{default:t(()=>[c("\u662F")]),_:1}),s(k,{label:"false",border:""},{default:t(()=>[c("\u5426")]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(e).noticeAll==="false"?(i(),n(d,{key:3,label:"\u63D0\u9192\u7528\u6237",prop:"phones"},{default:t(()=>[s(D,{buttonText:"+\u624B\u673A\u53F7",modelValue:l(e).phoneList,"onUpdate:modelValue":a[8]||(a[8]=o=>l(e).phoneList=o)},null,8,["modelValue"])]),_:1})):V("",!0)]),_:1},8,["model","rules"])),[[j,l(g)]])]),_:1},8,["modelValue"])}}});export{X as default};
