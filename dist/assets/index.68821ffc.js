import{d as at,u as x,y as N,b as qe,__tla as lt}from"./index.0f5ebb0a.js";import{l as Fe,r as k,R as Ve,aa as c,ah as Pe,m as u,q as h,t as o,F as p,M as ot,u as t,L as l,E as r,a0 as rt,K as I,$ as L,D as m,I as _,J as s,j as st,H as g,A as it,av as Ie}from"./vue.4dfaac09.js";import{u as nt}from"./table.6d12d51c.js";import{f as ut,s as bt,b as ct,r as pt,d as dt}from"./job.61b89b1c.js";import{u as mt}from"./dict.10eb31b5.js";let Le,yt=Promise.all([(()=>{try{return lt}catch{}})()]).then(async()=>{let R,D,z,G,O,U,A,H,K,J,Q,M,W,X,Y,Z,ee,te,ae,le,oe,re,se,ie,ne,ue,be,ce,pe,de,me,ye,je;R={class:"layout-padding"},D={class:"layout-padding-auto layout-padding-view"},z={class:"mb8",style:{width:"100%"}},G={class:"p-4"},O={class:"mx-auto"},U={class:"grid grid-cols-4 gap-x-4 gap-y-6"},A={"aria-label":"header",class:"flex items-center p-4 space-x-4"},H={"aria-label":"avatar",class:"flex items-center mr-auto space-x-4"},K={class:"flex flex-col flex-1 space-y-2"},J={class:"text-lg font-bold text-gray-900 dark:text-gray-100"},Q={class:"text-base font-normal text-gray-500 truncate dark:text-gray-400"},M={"aria-label":"navigation",class:"py-2"},W={class:"grid gap-1"},X={class:"flex items-center w-full px-4 py-1 space-x-3 leading-6 text-gray-600 dark:text-gray-300 hover:bg-white dark:hover:bg-[#303030] rounded-md"},Y={class:"font-medium"},Z={class:"flex items-center w-full px-4 py-1 space-x-3 leading-6 text-gray-600 dark:text-gray-300 hover:bg-white dark:hover:bg-[#303030] rounded-md"},ee={class:"font-medium"},te={class:"flex items-center w-full px-4 py-1 space-x-3 leading-6 text-gray-600 dark:text-gray-300 hover:bg-white dark:hover:bg-[#303030] rounded-md"},ae={class:"font-medium"},le={class:"flex items-center w-full px-4 py-1 space-x-3 leading-6 text-gray-600 dark:text-gray-300 hover:bg-white dark:hover:bg-[#303030] rounded-md"},oe={class:"font-medium"},re={class:"flex items-center w-full px-4 py-1 space-x-3 leading-6 text-gray-600 dark:text-gray-300 hover:bg-white dark:hover:bg-[#303030] rounded-md"},se={class:"font-medium"},ie={"aria-label":"footer",class:"pt-2 border-t dark:border-[#303030]"},ne={class:"flex items-center justify-center min-w-full"},ue={class:"flex"},be=["onClick"],ce=["onClick"],pe=["onClick"],de=["onClick"],me=["onClick"],ye=["onClick"],je=Fe({name:"systemSysJob"}),Le=Fe({...je,setup(jt){const Re=Ie(()=>qe(()=>import("./form.e65a21e9.js").then(async a=>(await a.__tla,a)),["assets/form.e65a21e9.js","assets/index.0f5ebb0a.js","assets/vue.4dfaac09.js","assets/index.3d43c53c.css","assets/dict.10eb31b5.js","assets/job.61b89b1c.js"])),De=Ie(()=>qe(()=>import("./job-log.fb5dc702.js"),["assets/job-log.fb5dc702.js","assets/table.6d12d51c.js","assets/index.0f5ebb0a.js","assets/vue.4dfaac09.js","assets/index.3d43c53c.css","assets/dict.10eb31b5.js"])),{t:n}=at(),q=k(),fe=k(),$=k(!1),F=Ve({jobName:"",jobGroup:"",jobStatus:"",jobExecuteStatus:""}),T=k(!0),V=k([]),xe=k(!0),{job_status:P,job_execute_status:he,misfire_policy:ze,job_type:_e}=mt("job_status","job_execute_status","misfire_policy","job_type"),d=Ve({queryForm:F,pageList:ut,pagination:{size:8,pageSizes:[4,8,12]}}),{getDataList:w,currentChangeHandle:Ge,sizeChangeHandle:Oe,downBlobFile:Ue,tableStyle:we}=nt(d),Ae=()=>{Object.keys(F).forEach(a=>F[a]=""),w()},He=a=>{V.value=a,xe.value=!a.length},Ke=()=>{Ue("/job/sys-job/export",Object.assign(d.queryForm,{ids:V}),"job.xlsx")},ve=a=>{fe.value.openDialog(a.jobId)},ge=a=>{const i=a.jobStatus;i==="1"||i==="3"?q.value.openDialog(a.jobId):x().error("\u8FD0\u884C\u4E2D\u5B9A\u65F6\u4EFB\u52A1\u4E0D\u53EF\u4FEE\u6539\uFF0C\u8BF7\u5148\u6682\u505C\u540E\u64CD\u4F5C")},ke=async a=>{const i=a.jobStatus;if(i==="1"||i==="3"){try{await N().confirm(`\u5373\u5C06\u53D1\u5E03\u6216\u542F\u52A8(\u4EFB\u52A1\u540D\u79F0: ${a.jobName}), \u662F\u5426\u7EE7\u7EED?`)}catch{return}try{await bt(a.jobId),w(),x().success(n("common.optSuccessText"))}catch(S){x().error(S.msg)}}else x().error("\u5B9A\u65F6\u4EFB\u52A1\u5DF2\u8FD0\u884C")},Se=async a=>{if(a.jobStatus==="2"){try{await N().confirm(`\u5373\u5C06\u6682\u505C(\u4EFB\u52A1\u540D\u79F0: ${a.jobName}), \u662F\u5426\u7EE7\u7EED?`)}catch{return}try{await ct(a.jobId),w(),x().success(n("common.optSuccessText"))}catch(i){x().error(i.msg)}}else x().error("\u5DF2\u6682\u505C\uFF0C\u4E0D\u8981\u91CD\u590D\u64CD\u4F5C")},Ce=async a=>{try{await N().confirm(`\u7ACB\u523B\u6267\u884C\u4E00\u6B21\u4EFB\u52A1(\u4EFB\u52A1\u540D\u79F0: ${a.jobName}), \u662F\u5426\u7EE7\u7EED?`)}catch{return}try{await pt(a.jobId),w(),x().success(n("common.optSuccessText"))}catch{x().error("\u8FD0\u884C\u5931\u8D25")}},E=async a=>{if(!a)return void V.value.forEach(E);const{jobId:i,jobName:S}=a;try{await N().confirm(`${n("common.delConfirmText")}(\u4EFB\u52A1\u540D\u79F0:${S})`)}catch{return}try{await dt(i),w(),x().success(n("common.delSuccessText"))}catch{x().error("\u5220\u9664\u5931\u8D25")}};return(a,i)=>{const S=c("el-input"),C=c("el-form-item"),$e=c("el-option"),Te=c("el-select"),f=c("el-button"),Je=c("el-form"),Ee=c("el-row"),Qe=c("el-tooltip"),Me=c("right-toolbar"),b=c("el-table-column"),B=c("dict-tag"),We=c("el-table"),Xe=c("CircleCloseFilled"),Be=c("el-icon"),Ye=c("CircleCheckFilled"),Ze=c("el-scrollbar"),et=c("pagination"),y=Pe("auth"),tt=Pe("loading");return u(),h("div",R,[o("div",D,[p(l(Ee,{class:"ml10"},{default:r(()=>[l(Je,{inline:!0,model:t(d).queryForm,ref:"queryRef"},{default:r(()=>[l(C,{label:a.$t("job.jobName"),prop:"jobName"},{default:r(()=>[l(S,{placeholder:a.$t("job.inputjobNameTip"),onKeyup:rt(t(w),["enter"]),clearable:"",modelValue:t(d).queryForm.jobName,"onUpdate:modelValue":i[0]||(i[0]=e=>t(d).queryForm.jobName=e)},null,8,["placeholder","onKeyup","modelValue"])]),_:1},8,["label"]),l(C,{label:t(n)("job.jobStatus"),prop:"jobStatus"},{default:r(()=>[l(Te,{placeholder:t(n)("job.inputjobStatusTip"),modelValue:t(d).queryForm.jobStatus,"onUpdate:modelValue":i[1]||(i[1]=e=>t(d).queryForm.jobStatus=e)},{default:r(()=>[(u(!0),h(I,null,L(t(P),(e,j)=>(u(),m($e,{key:j,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["placeholder","modelValue"])]),_:1},8,["label"]),l(C,{label:t(n)("job.jobExecuteStatus"),prop:"jobExecuteStatus"},{default:r(()=>[l(Te,{placeholder:t(n)("job.inputjobExecuteStatusTip"),modelValue:t(d).queryForm.jobExecuteStatus,"onUpdate:modelValue":i[2]||(i[2]=e=>t(d).queryForm.jobExecuteStatus=e)},{default:r(()=>[(u(!0),h(I,null,L(t(he),(e,j)=>(u(),m($e,{key:j,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["placeholder","modelValue"])]),_:1},8,["label"]),l(C,null,{default:r(()=>[l(f,{onClick:t(w),icon:"Search",type:"primary"},{default:r(()=>[_(s(a.$t("common.queryBtn")),1)]),_:1},8,["onClick"]),l(f,{onClick:Ae,icon:"Refresh"},{default:r(()=>[_(s(a.$t("common.resetBtn")),1)]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},512),[[ot,t(T)]]),l(Ee,null,{default:r(()=>[o("div",z,[p((u(),m(f,{onClick:i[3]||(i[3]=e=>t(q).openDialog()),class:"ml10",icon:"folder-add",type:"primary"},{default:r(()=>[_(s(a.$t("common.addBtn")),1)]),_:1})),[[y,"job_sys_job_add"]]),p((u(),m(f,{plain:"",disabled:t(xe),onClick:i[4]||(i[4]=e=>E(void 0)),class:"ml10",icon:"Delete",type:"primary"},{default:r(()=>[_(s(a.$t("common.delBtn")),1)]),_:1},8,["disabled"])),[[y,"job_sys_job_del"]]),l(Me,{export:"job_sys_job_add",onExportExcel:Ke,onQueryTable:t(w),class:"ml10",style:{float:"right","margin-right":"20px"},showSearch:t(T),"onUpdate:showSearch":i[6]||(i[6]=e=>st(T)?T.value=e:null)},{default:r(()=>[l(Qe,{class:"item",effect:"dark",content:a.$t("queryTree.view"),placement:"top"},{default:r(()=>[l(f,{circle:"",icon:"Grid",onClick:i[5]||(i[5]=e=>$.value=!t($))})]),_:1},8,["content"])]),_:1},8,["onQueryTable","showSearch"])])]),_:1}),t($)?p((u(),m(We,{key:0,data:t(d).dataList,onSelectionChange:He,style:{width:"100%"},"row-key":"jobId",border:"","cell-style":t(we).cellStyle,"header-cell-style":t(we).headerCellStyle},{default:r(()=>[l(b,{align:"center",type:"selection",width:"40"}),l(b,{label:t(n)("job.index"),fixed:"left",type:"index",width:"60"},null,8,["label"]),l(b,{label:t(n)("job.jobName"),fixed:"left",prop:"jobName","show-overflow-tooltip":"",width:"120"},null,8,["label"]),l(b,{label:t(n)("job.jobGroup"),prop:"jobGroup","show-overflow-tooltip":"",width:"120"},null,8,["label"]),l(b,{label:t(n)("job.jobStatus"),prop:"jobStatus","show-overflow-tooltip":"",width:"120"},{default:r(e=>[l(B,{options:t(P),value:e.row.jobStatus},null,8,["options","value"])]),_:1},8,["label"]),l(b,{label:t(n)("job.jobExecuteStatus"),prop:"jobExecuteStatus","show-overflow-tooltip":"",width:"120"},{default:r(e=>[l(B,{options:t(he),value:e.row.jobExecuteStatus},null,8,["options","value"])]),_:1},8,["label"]),l(b,{label:t(n)("job.startTime"),prop:"startTime","show-overflow-tooltip":"",width:"120"},null,8,["label"]),l(b,{label:t(n)("job.previousTime"),prop:"previousTime","show-overflow-tooltip":"",width:"120"},null,8,["label"]),l(b,{label:t(n)("job.nextTime"),prop:"nextTime","show-overflow-tooltip":"",width:"120"},null,8,["label"]),l(b,{label:t(n)("job.jobType"),prop:"jobType","show-overflow-tooltip":"",width:"120"},{default:r(e=>[l(B,{options:t(_e),value:e.row.jobType},null,8,["options","value"])]),_:1},8,["label"]),l(b,{label:t(n)("job.executePath"),prop:"executePath","show-overflow-tooltip":"",width:"120"},null,8,["label"]),l(b,{label:t(n)("job.className"),prop:"className","show-overflow-tooltip":"",width:"120"},null,8,["label"]),l(b,{label:t(n)("job.methodName"),prop:"methodName","show-overflow-tooltip":"",width:"120"},null,8,["label"]),l(b,{label:t(n)("job.methodParamsValue"),prop:"methodParamsValue","show-overflow-tooltip":"",width:"120"},null,8,["label"]),l(b,{label:t(n)("job.cronExpression"),prop:"cronExpression","show-overflow-tooltip":"",width:"120"},null,8,["label"]),l(b,{label:t(n)("job.misfirePolicy"),prop:"misfirePolicy","show-overflow-tooltip":"",width:"200"},{default:r(e=>[l(B,{options:t(ze),value:e.row.misfirePolicy},null,8,["options","value"])]),_:1},8,["label"]),l(b,{label:a.$t("common.action"),fixed:"right",width:"300"},{default:r(e=>[l(f,{onClick:j=>ve(e.row),text:"",type:"primary"},{default:r(()=>[_(s(a.$t("job.jobLogBtn")),1)]),_:2},1032,["onClick"]),e.row.jobStatus!=="2"?p((u(),m(f,{key:0,onClick:j=>ke(e.row),text:"",type:"primary"},{default:r(()=>[_(s(a.$t("job.jobStartBtn")),1)]),_:2},1032,["onClick"])),[[y,"job_sys_job_start_job"]]):g("",!0),e.row.jobStatus==="2"?p((u(),m(f,{key:1,onClick:j=>Se(e.row),text:"",type:"primary"},{default:r(()=>[_(s(a.$t("job.jobPauseBtn")),1)]),_:2},1032,["onClick"])),[[y,"job_sys_job_shutdown_job"]]):g("",!0),p((u(),m(f,{onClick:j=>ge(e.row),text:"",type:"primary"},{default:r(()=>[_(s(a.$t("common.editBtn")),1)]),_:2},1032,["onClick"])),[[y,"job_sys_job_edit"]]),p((u(),m(f,{onClick:j=>Ce(e.row),text:"",type:"primary"},{default:r(()=>[_(s(a.$t("job.jobRunBtn")),1)]),_:2},1032,["onClick"])),[[y,"job_sys_job_start_job"]]),p((u(),m(f,{onClick:j=>E(e.row),text:"",type:"primary",disabled:e.row.jobStatus==="2"},{default:r(()=>[_(s(a.$t("common.delBtn")),1)]),_:2},1032,["onClick","disabled"])),[[y,"job_sys_job_del"]])]),_:1},8,["label"])]),_:1},8,["data","cell-style","header-cell-style"])),[[tt,t(d).loading]]):g("",!0),t($)?g("",!0):(u(),m(Ze,{key:1},{default:r(()=>[o("div",G,[o("div",O,[o("div",U,[(u(!0),h(I,null,L(t(d).dataList,e=>{var j,Ne;return u(),h("div",{key:e.jobId,class:"w-full max-w-sm mt-2 bg-gray-100 dark:bg-[#1d1e1f] rounded-lg border dark:border-[#303030]"},[o("div",A,[o("div",H,[o("div",K,[o("div",J,s(e.jobName),1),o("p",Q,s(e.jobGroup)+" / "+s((j=t(_e).find(v=>v.value===e.jobType))==null?void 0:j.label),1)])])]),o("div",M,[o("nav",W,[o("div",X,[o("span",Y,s(a.$t("job.jobStatus"))+":",1),o("span",null,s((Ne=t(P).find(v=>v.value===e.jobStatus))==null?void 0:Ne.label),1)]),o("div",Z,[o("span",ee,s(a.$t("job.cronExpression"))+":",1),o("span",null,s(e.cronExpression),1)]),o("div",te,[o("span",ae,s(a.$t("job.previousTime"))+":",1),o("span",null,s(e.previousTime),1)]),o("div",le,[o("span",oe,s(a.$t("job.nextTime"))+":",1),o("span",null,s(e.nextTime),1)]),o("div",re,[o("span",se,s(a.$t("job.jobExecuteStatus"))+":",1),o("span",null,[e.jobExecuteStatus==="1"?(u(),m(Be,{key:0},{default:r(()=>[l(Xe)]),_:1})):g("",!0),e.jobExecuteStatus==="0"?(u(),m(Be,{key:1},{default:r(()=>[l(Ye)]),_:1})):g("",!0)])])])]),o("div",ie,[o("div",ne,[o("nav",ue,[o("a",{onClick:v=>ve(e),href:"javascript:;",class:"px-2 py-2 text-primary hover:text-primary-400 dark:text-primary-300"},[o("span",null,s(a.$t("job.jobLogBtn")),1)],8,be),e.jobStatus!=="2"?p((u(),h("a",{key:0,onClick:v=>ke(e),href:"javascript:;",class:"px-2 py-2 text-primary hover:text-primary-400 dark:text-primary-300"},[o("span",null,s(a.$t("job.jobStartBtn")),1)],8,ce)),[[y,"job_sys_job_start_job"]]):g("",!0),e.jobStatus==="2"?p((u(),h("a",{key:1,onClick:v=>Se(e),href:"javascript:;",class:"px-2 py-2 text-primary hover:text-primary-400 dark:text-primary-300"},[o("span",null,s(a.$t("job.jobPauseBtn")),1)],8,pe)),[[y,"job_sys_job_shutdown_job"]]):g("",!0),p((u(),h("a",{onClick:v=>ge(e),href:"javascript:;",class:"px-2 py-2 text-primary hover:text-primary-400 dark:text-primary-300"},[o("span",null,s(a.$t("common.editBtn")),1)],8,de)),[[y,"job_sys_job_edit"]]),p((u(),h("a",{onClick:v=>Ce(e),href:"javascript:;",class:"px-2 py-2 text-primary hover:text-primary-400 dark:text-primary-300"},[o("span",null,s(a.$t("job.jobRunBtn")),1)],8,me)),[[y,"job_sys_job_start_job"]]),e.jobStatus!=="2"?p((u(),h("a",{key:2,onClick:v=>E(e),type:"primary",href:"javascript:;",class:"px-2 py-2 text-primary hover:text-primary-400 dark:text-primary-300"},[o("span",null,s(a.$t("common.delBtn")),1)],8,ye)),[[y,"job_sys_job_del"]]):g("",!0)])])])])}),128))])])])]),_:1})),l(et,it({onCurrentChange:t(Ge),onSizeChange:t(Oe)},t(d).pagination),null,16,["onCurrentChange","onSizeChange"])]),l(t(Re),{onRefresh:i[7]||(i[7]=e=>t(w)()),ref_key:"formDialogRef",ref:q},null,512),l(t(De),{ref_key:"jobLogRef",ref:fe},null,512)])}}})});export{yt as __tla,Le as default};
