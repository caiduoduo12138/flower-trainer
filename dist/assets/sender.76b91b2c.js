import{v as z}from"./index.c33ef0ff.js";import{r as h,u as x}from"./index.0f5ebb0a.js";import{g as q}from"./config.08f63081.js";import{s as D}from"./message.4096306f.js";import{l as _,r as f,R as E,aa as s,ah as F,m,D as n,E as o,t as O,L as t,I as g,F as R,H as b,u as S,n as J}from"./vue.4dfaac09.js";const H={class:"dialog-footer"},I=_({name:"EmailSenderDialog"}),B=_({...I,setup(G,{expose:L}){const p=f(),d=f(!1),u=f(!1),U=f(["jpeg","png","jpg","gif","md","doc","xls","ppt","txt","pdf","docx","xlsx","pptx","zip","rar"]),e=E({title:"",configType:"email",configKey:"",bizCode:"",configName:"",mailAddress:[],ccList:[],bccList:[],attachmentList:[],id:"",htmlValues:{},params:`{
    "code": "1234"
}`}),k=f({params:[{required:!0,message:"\u53C2\u6570\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:h.json,trigger:"blur"}],title:[{required:!0,message:"\u6807\u9898\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"},{validator:h.overLength,trigger:"blur"}],mailAddress:[{required:!0,message:"\u6536\u4EF6\u4EBA\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:"blur"}]}),C=async()=>{if(!await(p==null?void 0:p.value.validate().catch(()=>{})))return!1;try{u.value=!0,e.htmlValues=JSON.parse(e.params),await D(e),x().success("\u53D1\u9001\u6210\u529F"),d.value=!1}catch(i){x().error(i.msg)}finally{e.params=JSON.stringify(e.htmlValues),u.value=!1}},N=(i,l)=>{e.attachmentList=l.map(c=>c.fileUrl)},T=i=>{u.value=!0,q({id:i}).then(l=>{Object.assign(e,l.data[0]),e.bizCode=e.configKey}).finally(()=>{u.value=!1})};return L({openDialog:i=>{d.value=!0,e.id="",J(()=>{var l;(l=p.value)==null||l.resetFields()}),i&&(e.id=i,T(i))}}),(i,l)=>{const c=s("el-input"),r=s("el-form-item"),v=s("tip"),V=s("tag-list"),j=s("upload-file"),A=s("el-form"),y=s("el-button"),K=s("el-drawer"),w=F("loading");return m(),n(K,{title:"\u90AE\u4EF6\u53D1\u9001\u6D4B\u8BD5",modelValue:d.value,"onUpdate:modelValue":l[8]||(l[8]=a=>d.value=a),size:"50%"},{footer:o(()=>[O("span",H,[t(y,{onClick:l[7]||(l[7]=a=>d.value=!1)},{default:o(()=>[g("\u53D6\u6D88")]),_:1}),t(y,{type:"primary",onClick:C,disabled:u.value},{default:o(()=>[g("\u786E\u8BA4")]),_:1},8,["disabled"])])]),default:o(()=>[R((m(),n(A,{ref_key:"dataFormRef",ref:p,model:e,rules:k.value,"label-width":"100px"},{default:o(()=>[t(r,{label:"\u4E1A\u52A1\u540D\u79F0",prop:"configName"},{default:o(()=>[t(c,{modelValue:e.configName,"onUpdate:modelValue":l[0]||(l[0]=a=>e.configName=a),placeholder:"\u8BF7\u8F93\u5165\u4E1A\u52A1\u540D\u79F0",disabled:""},null,8,["modelValue"])]),_:1}),t(r,{label:"\u4E1A\u52A1\u7F16\u7801",prop:"configKey"},{label:o(()=>[g("\u4E1A\u52A1\u7F16\u7801 "),t(v,{content:"\u4EE3\u7801\u4E2D\u901A\u8FC7\u4E1A\u52A1\u7F16\u7801\u53D1\u9001"})]),default:o(()=>[t(c,{modelValue:e.configKey,"onUpdate:modelValue":l[1]||(l[1]=a=>e.configKey=a),placeholder:"\u8BF7\u8F93\u5165\u4E1A\u52A1\u7F16\u7801",disabled:""},null,8,["modelValue"])]),_:1}),t(r,{label:"\u6536\u4EF6\u4EBA",prop:"mailAddress"},{default:o(()=>[d.value?(m(),n(V,{key:0,buttonText:"+\u90AE\u7BB1",modelValue:e.mailAddress,"onUpdate:modelValue":l[2]||(l[2]=a=>e.mailAddress=a)},null,8,["modelValue"])):b("",!0)]),_:1}),t(r,{label:"\u6284\u9001\u4EBA",prop:"ccList"},{default:o(()=>[d.value?(m(),n(V,{key:0,buttonText:"+\u90AE\u7BB1",modelValue:e.ccList,"onUpdate:modelValue":l[3]||(l[3]=a=>e.ccList=a)},null,8,["modelValue"])):b("",!0)]),_:1}),t(r,{label:"\u5BC6\u6284\u4EBA",prop:"bccList"},{default:o(()=>[d.value?(m(),n(V,{key:0,buttonText:"+\u90AE\u7BB1",modelValue:e.bccList,"onUpdate:modelValue":l[4]||(l[4]=a=>e.bccList=a)},null,8,["modelValue"])):b("",!0)]),_:1}),t(r,{label:"\u4E3B\u9898",prop:"title"},{default:o(()=>[t(c,{modelValue:e.title,"onUpdate:modelValue":l[5]||(l[5]=a=>e.title=a)},null,8,["modelValue"])]),_:1}),t(r,{prop:"params"},{label:o(()=>[g("\u53C2\u6570 "),t(v,{content:"\u53C2\u8003\u90AE\u4EF6\u6A21\u677F\u53C2\u6570\u914D\u7F6E"})]),default:o(()=>[t(S(z),{ref:"jsonEditorRef",modelValue:e.params,"onUpdate:modelValue":l[6]||(l[6]=a=>e.params=a)},null,8,["modelValue"])]),_:1}),t(r,{label:"\u9644\u4EF6",prop:"attachmentList"},{default:o(()=>[d.value?(m(),n(j,{key:0,limit:5,onChange:N,fileType:U.value},null,8,["fileType"])):b("",!0)]),_:1})]),_:1},8,["model","rules"])),[[w,u.value]])]),_:1},8,["modelValue"])}}});export{B as default};
